# wxautox å¼€å‘æ–‡æ¡£

**ä½œè€…**ï¼šCluic  
**æ›´æ–°æ—¥æœŸ**ï¼š2024-12-17  
**ç‰ˆæœ¬**ï¼šPlus Version 3.9.11.17.21  
**è‡´**ï¼š6LSq5qKm5piv5Y+q54yr4Kmt

---

## é¡¹ç›®ä»‹ç»

**wxautox** æ˜¯ **wxauto** çš„å¢å¼ºç‰ˆï¼ŒåŸºäº Python å¼€å‘ï¼Œä¸“ä¸ºå¾®ä¿¡æ¡Œé¢å®¢æˆ·ç«¯è®¾è®¡ã€‚å®ƒåœ¨ä¿ç•™ **wxauto** æ‰€æœ‰åŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥å®Œå–„å’Œæå‡äº†ç”¨æˆ·ä½“éªŒä¸æ€§èƒ½ã€‚**wxautox** é€‚ç”¨äºéœ€è¦æ›´å¼ºå¤§è‡ªåŠ¨åŒ–èƒ½åŠ›çš„å¼€å‘è€…å’Œä¼ä¸šç”¨æˆ·ï¼Œæä¾›äº†é«˜çº§åŠŸèƒ½å¦‚æœ‹å‹åœˆæ“ä½œã€æ¶ˆæ¯å…æ‰“æ‰°ã€ç¾¤ç®¡ç†ã€è‡ªåŠ¨ä¿å­˜æ–‡ä»¶ç­‰ã€‚

## ç›®å½•

- [é¡¹ç›®ä»‹ç»](#é¡¹ç›®ä»‹ç»)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [å¿«é€Ÿå…¥é—¨](#å¿«é€Ÿå…¥é—¨)
- [æ–¹æ³•è¯´æ˜](#æ–¹æ³•è¯´æ˜)
  - [1. ç›‘å¬](#1-ç›‘å¬)
    - [1.1 æ·»åŠ ç›‘å¬å¯¹è±¡ `AddListenChat`](#11-æ·»åŠ ç›‘å¬å¯¹è±¡-addlistenchat)
    - [1.2 è·å–ç›‘å¬æ¶ˆæ¯ `GetListenMessage`](#12-è·å–ç›‘å¬æ¶ˆæ¯-getlistenmessage)
    - [1.3 ç§»é™¤ç›‘å¬å¯¹è±¡ `RemoveListenChat`](#13-ç§»é™¤ç›‘å¬å¯¹è±¡-removelistenchat)
    - [1.4 è·å–æ‰€æœ‰ç›‘å¬å¯¹è±¡ `GetAllListenChat`](#14-è·å–æ‰€æœ‰ç›‘å¬å¯¹è±¡-getalllistenchat)
    - [1.5 ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªæ¶ˆæ¯å›å¤æœºå™¨äºº](#15-ç¤ºä¾‹åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯å›å¤æœºå™¨äºº)
  - [2. å‘é€æ¶ˆæ¯](#2-å‘é€æ¶ˆæ¯)
    - [2.1 å‘é€æ–‡å­—æ¶ˆæ¯ `SendMsg`](#21-å‘é€æ–‡å­—æ¶ˆæ¯-sendmsg)
    - [2.2 å‘é€æ‰“å­—æœºæ¨¡å¼æ¶ˆæ¯ `SendTypingText`](#22-å‘é€æ‰“å­—æœºæ¨¡å¼æ¶ˆæ¯-sendtypingtext)
    - [2.3 å‘é€å›¾ç‰‡/è§†é¢‘/æ–‡ä»¶æ¶ˆæ¯ `SendFiles`](#23-å‘é€å›¾ç‰‡è§†é¢‘æ–‡ä»¶æ¶ˆæ¯-sendfiles)
    - [2.4 å‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ… `SendEmotion`](#24-å‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ…-sendemotion)
    - [2.5 æ¶ˆæ¯å…æ‰“æ‰° `MuteNotifications`](#25-æ¶ˆæ¯å…æ‰“æ‰°-mutenotifications)
    - [2.6 é‚€è¯·å…¥ç¾¤ `AddGroupMembers`](#26-é‚€è¯·å…¥ç¾¤-addgroupmembers)
    - [2.7 ä¼˜åŒ– `ChatWith` æ–¹æ³•](#27-ä¼˜åŒ–-chatwith-æ–¹æ³•)
    - [2.8 ä¿®æ”¹ç¾¤èŠåã€å¤‡æ³¨ã€ç¾¤å…¬å‘Šã€æˆ‘åœ¨æœ¬ç¾¤çš„æ˜µç§° `ManageGroup`](#28-ä¿®æ”¹ç¾¤èŠåå¤‡æ³¨ç¾¤å…¬å‘Šæˆ‘åœ¨æœ¬ç¾¤çš„æ˜µç§°-managegroup)
    - [2.9 ä¿®æ”¹å¥½å‹å¤‡æ³¨ã€å¢åŠ æ ‡ç­¾ `ManageFriend`](#29-ä¿®æ”¹å¥½å‹å¤‡æ³¨å¢åŠ æ ‡ç­¾-managefriend)
    - [2.10 è‡ªåŠ¨ä¿å­˜æ¶ˆæ¯å†…çš„å¡ç‰‡é“¾æ¥ `parseurl` å‚æ•°](#210-è‡ªåŠ¨ä¿å­˜æ¶ˆæ¯å†…çš„å¡ç‰‡é“¾æ¥-parseurl-å‚æ•°)
    - [2.11 è·å–å½“å‰èŠå¤©çª—å£è¯¦æƒ… `CurrentChat` æ–¹æ³•å¢åŠ  `details` å‚æ•°](#211-è·å–å½“å‰èŠå¤©çª—å£è¯¦æƒ…-currentchat-æ–¹æ³•å¢åŠ -details-å‚æ•°)
  - [3. è·å–æ¶ˆæ¯](#3-è·å–æ¶ˆæ¯)
    - [3.1 è·å–å½“å‰èŠå¤©çª—å£æ‰€æœ‰æ¶ˆæ¯ `GetAllMessage`](#31-è·å–å½“å‰èŠå¤©çª—å£æ‰€æœ‰æ¶ˆæ¯-getallmessage)
    - [3.2 åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯ `LoadMoreMessage`](#32-åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯-loadmoremessage)
    - [3.3 è·å–æ–°æ¶ˆæ¯](#33-è·å–æ–°æ¶ˆæ¯)
      - [3.3.1 è·å–ä¸»çª—å£æ–°æ¶ˆæ¯](#331-è·å–ä¸»çª—å£æ–°æ¶ˆæ¯)
      - [3.3.2 ç›‘å¬æ¶ˆæ¯ `GetListenMessage`](#332-ç›‘å¬æ¶ˆæ¯-getlistenmessage)
  - [4. æ·»åŠ å¥½å‹](#4-æ·»åŠ å¥½å‹)
    - [4.1 å‘èµ·å¥½å‹ç”³è¯· `AddNewFriend`](#41-å‘èµ·å¥½å‹ç”³è¯·-addnewfriend)
    - [4.2 æ¥å—å¥½å‹è¯·æ±‚](#42-æ¥å—å¥½å‹è¯·æ±‚)
      - [4.2.1 è·å–æ–°çš„å¥½å‹ç”³è¯·å¯¹è±¡åˆ—è¡¨ `GetNewFriends`](#421-è·å–æ–°çš„å¥½å‹ç”³è¯·å¯¹è±¡åˆ—è¡¨-getnewfriends)
      - [4.2.2 é€šè¿‡å¥½å‹ç”³è¯·å¯¹è±¡æ¥å—å¥½å‹è¯·æ±‚](#422-é€šè¿‡å¥½å‹ç”³è¯·å¯¹è±¡æ¥å—å¥½å‹è¯·æ±‚)
  - [5. åˆ‡æ¢èŠå¤©çª—å£](#5-åˆ‡æ¢èŠå¤©çª—å£)
    - [5.1 åˆ‡æ¢åˆ°æŒ‡å®šå¥½å‹èŠå¤©æ¡† `ChatWith`](#51-åˆ‡æ¢åˆ°æŒ‡å®šå¥½å‹èŠå¤©æ¡†-chatwith)
    - [5.2 åˆ‡æ¢å¾®ä¿¡ä¸»é¡µé¢](#52-åˆ‡æ¢å¾®ä¿¡ä¸»é¡µé¢)
      - [5.2.1 åˆ‡æ¢åˆ°èŠå¤©é¡µé¢ `SwitchToChat`](#521-åˆ‡æ¢åˆ°èŠå¤©é¡µé¢-switchtochat)
      - [5.2.2 åˆ‡æ¢åˆ°é€šè®¯å½•é¡µé¢ `SwitchToContact`](#522-åˆ‡æ¢åˆ°é€šè®¯å½•é¡µé¢-switchtocontact)
  - [6. è·å–å¥½å‹ä¿¡æ¯](#6-è·å–å¥½å‹ä¿¡æ¯)
    - [6.1 è·å–ç²—ç•¥ä¿¡æ¯ `GetAllFriends`](#61-è·å–ç²—ç•¥ä¿¡æ¯-getallfriends)
    - [6.2 è·å–è¯¦ç»†ä¿¡æ¯ `GetAllFriendDetails`](#62-è·å–è¯¦ç»†ä¿¡æ¯-getallfrienddetails)
    - [6.3 è·å–æ‰€æœ‰å¥½å‹è¯¦æƒ… `GetFriendDetails`](#63-è·å–æ‰€æœ‰å¥½å‹è¯¦æƒ…-getfrienddetails)
- [å¯¹è±¡è¯´æ˜](#å¯¹è±¡è¯´æ˜)
  - [1. æ¶ˆæ¯å¯¹è±¡](#1-æ¶ˆæ¯å¯¹è±¡)
    - [1.1 ç³»ç»Ÿæ¶ˆæ¯](#11-ç³»ç»Ÿæ¶ˆæ¯)
    - [1.2 æ—¶é—´æ¶ˆæ¯](#12-æ—¶é—´æ¶ˆæ¯)
    - [1.3 æ’¤å›æ¶ˆæ¯](#13-æ’¤å›æ¶ˆæ¯)
    - [1.4 å¥½å‹æ¶ˆæ¯](#14-å¥½å‹æ¶ˆæ¯)
    - [1.5 è‡ªå·±çš„æ¶ˆæ¯](#15-è‡ªå·±çš„æ¶ˆæ¯)
  - [2. èŠå¤©çª—å£å¯¹è±¡](#2-èŠå¤©çª—å£å¯¹è±¡)
  - [3. ä¼šè¯å¯¹è±¡](#3-ä¼šè¯å¯¹è±¡)
  - [4. æœ‹å‹åœˆå¯¹è±¡](#4-æœ‹å‹åœˆå¯¹è±¡)
    - [4.1 çª—å£å¯¹è±¡](#41-çª—å£å¯¹è±¡)
      - [4.1.1 è·å–æœ‹å‹åœˆå†…å®¹ `GetMoments`](#411-è·å–æœ‹å‹åœˆå†…å®¹-getmoments)
      - [4.1.2 åˆ·æ–°æœ‹å‹åœˆ `Refresh`](#412-åˆ·æ–°æœ‹å‹åœˆ-refresh)
      - [4.1.3 å…³é—­æœ‹å‹åœˆ `Close`](#413-å…³é—­æœ‹å‹åœˆ-close)
    - [4.2 æ¶ˆæ¯å¯¹è±¡](#42-æ¶ˆæ¯å¯¹è±¡)
      - [4.2.1 è·å–æœ‹å‹åœˆå†…å®¹](#421-è·å–æœ‹å‹åœˆå†…å®¹)
      - [4.2.2 è·å–æœ‹å‹åœˆå›¾ç‰‡ `SaveImages`](#422-è·å–æœ‹å‹åœˆå›¾ç‰‡-saveimages)
      - [4.2.3 è·å–å¥½å‹ä¿¡æ¯ `sender_info`](#423-è·å–å¥½å‹ä¿¡æ¯-sender_info)
      - [4.2.4 è·å–å½“å‰èŠå¤©é¡µé¢è¯¦æƒ… `details` å±æ€§](#424-è·å–å½“å‰èŠå¤©é¡µé¢è¯¦æƒ…-details-å±æ€§)
      - [4.2.5 è§£æå¡ç‰‡é“¾æ¥ `parse_url` æ–¹æ³•](#425-è§£æå¡ç‰‡é“¾æ¥-parse_url-æ–¹æ³•)
- [æ–‡ä»¶ç®¡ç†å¯¹è±¡](#æ–‡ä»¶ç®¡ç†å¯¹è±¡)
  - [1. æ–‡ä»¶çª—å£å¯¹è±¡](#1-æ–‡ä»¶çª—å£å¯¹è±¡)
    - [1.1 è·å–èŠå¤©å¯¹è±¡åç§°](#11-è·å–èŠå¤©å¯¹è±¡åç§°)
    - [1.2 è·å–èŠå¤©å¯¹è±¡åˆ—è¡¨](#12-è·å–èŠå¤©å¯¹è±¡åˆ—è¡¨)
    - [1.3 æ‰“å¼€æŒ‡å®šèŠå¤©ä¼šè¯ `ChatWithFile`](#13-æ‰“å¼€æŒ‡å®šèŠå¤©ä¼šè¯-chatwithfile)
    - [1.4 ä¸‹è½½æ–‡ä»¶ `DownloadFiles`](#14-ä¸‹è½½æ–‡ä»¶-downloadfiles)
  - [2. æ–‡ä»¶ç®¡ç†æ–¹æ³•](#2-æ–‡ä»¶ç®¡ç†æ–¹æ³•)
- [å…¶ä»–å¯¹è±¡](#å…¶ä»–å¯¹è±¡)
  - [WeChatFiles å¯¹è±¡](#wechatfiles-å¯¹è±¡)

---

## ç¯å¢ƒé…ç½®

### 1. ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10ã€Windows 11 æˆ– Windows Server 2016 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
- **Python**ï¼šPython 3.7 åŠä»¥ä¸Šç‰ˆæœ¬ï¼ˆä¸æ”¯æŒ Python 3.7.6 å’Œ 3.8.1ï¼‰ã€‚

> **æ³¨æ„**ï¼šè¯·ç¡®ä¿ Python ç‰ˆæœ¬ä¸ä¸º 3.7.6 å’Œ 3.8.1ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´å®‰è£…æˆ–è¿è¡Œå¤±è´¥ã€‚

### 2. å®‰è£… wxautox

- **æ ¹æ®ä¼šå‘˜ç¾¤çš„æ–‡ä»¶è¿›è¡Œå®‰è£…**

> **è¯´æ˜**ï¼šè¯·ä»æˆ‘ä»¬çš„ä¼šå‘˜å¾®ä¿¡ç¾¤è·å–å®‰è£…æ–‡ä»¶å’Œç›¸å…³å®‰è£…æŒ‡å¯¼ï¼Œä»¥ç¡®ä¿æ­£ç¡®å®‰è£… wxautoxã€‚

### 3. å¾®ä¿¡ç‰ˆæœ¬è¦æ±‚

å½“å‰ wxautox é¡¹ç›®çš„é»˜è®¤åˆ†æ”¯é€‚é…å¾®ä¿¡ç‰ˆæœ¬ä¸º **3.9.11.17**ã€‚è¯·åœ¨ä½¿ç”¨å‰ç¡®è®¤ç”µè„‘ä¸Šçš„å¾®ä¿¡å®¢æˆ·ç«¯ç‰ˆæœ¬æ˜¯å¦ä¸ºè¯¥ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ä¸åŒ¹é…å¯èƒ½ä¼šå›  UI å·®å¼‚å¯¼è‡´éƒ¨åˆ†åŠŸèƒ½æ— æ³•æ­£å¸¸è°ƒç”¨ã€‚

> **æ³¨**ï¼šå¦‚æœæ‚¨çš„å¾®ä¿¡ç‰ˆæœ¬ä¸é»˜è®¤åˆ†æ”¯å…¼å®¹ï¼Œæ— éœ€è¿‡å¤šæ‹…å¿ƒç‰ˆæœ¬é—®é¢˜ã€‚

---

## å¿«é€Ÿå…¥é—¨

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ wxautox å®ç°å¾®ä¿¡è‡ªåŠ¨åŒ–æ“ä½œã€‚

### 3åˆ†é’Ÿå¿«é€Ÿå®ç°å¾®ä¿¡è‡ªåŠ¨åŒ–

#### 1. è·å–å¾®ä¿¡å¯¹è±¡

é¦–å…ˆï¼Œå¯¼å…¥ wxautox å¹¶è·å–å¾®ä¿¡çª—å£å¯¹è±¡ï¼š

```python
from wxautox import WeChat

# è·å–å¾®ä¿¡çª—å£å¯¹è±¡
wx = WeChat()
# è¾“å‡ºç¤ºä¾‹: åˆå§‹åŒ–æˆåŠŸï¼Œè·å–åˆ°å·²ç™»å½•çª—å£ï¼šxxxx
```

> **æ³¨æ„**ï¼šè¯·å…ˆç™»å½• PC å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œå†è¿è¡Œä¸Šè¿°ä»£ç ã€‚

> **æç¤º**ï¼šä¸Šè¿°ä»£ç ä¸­å®šä¹‰äº† `wx` å˜é‡ï¼Œåç»­æ–‡æ¡£ä¸­å°†ç›´æ¥ä½¿ç”¨è¯¥å˜é‡ï¼Œæ— éœ€é‡å¤å®šä¹‰ã€‚

#### 2. åˆ›å»ºä¸€ä¸ªç®€å•çš„æ¶ˆæ¯å›å¤æœºå™¨äºº

é€šè¿‡ä»¥ä¸‹æ­¥éª¤ï¼Œåˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿè‡ªåŠ¨å›å¤ç‰¹å®šå¥½å‹æˆ–ç¾¤èŠæ¶ˆæ¯çš„æœºå™¨äººã€‚

**æ­¥éª¤ä¸€**ï¼šè®¾ç½®ç›‘å¬åˆ—è¡¨ï¼ŒåŒ…å«æŒ‡å®šå¥½å‹æˆ–ç¾¤èŠçš„æ˜µç§°ã€‚

```python
listen_list = [
    'å¼ ä¸‰',
    'æå››',
    'å·¥ä½œç¾¤A',
    'å·¥ä½œç¾¤B'
]
```

**æ­¥éª¤äºŒ**ï¼šæ·»åŠ ç›‘å¬å¯¹è±¡ï¼Œå¯é€‰å‚æ•° `savepic` å†³å®šæ˜¯å¦ä¿å­˜æ–°æ¶ˆæ¯ä¸­çš„å›¾ç‰‡ã€‚

```python
for chat in listen_list:
    wx.AddListenChat(who=chat, savepic=True)
```

**æ­¥éª¤ä¸‰**ï¼šæŒç»­ç›‘å¬æ¶ˆæ¯ï¼Œæ”¶åˆ°å¥½å‹ç±»å‹çš„æ¶ˆæ¯åè‡ªåŠ¨å›å¤â€œæ”¶åˆ°â€ã€‚

```python
import time

wait = 1  # è®¾ç½®æ¯éš”1ç§’æ£€æŸ¥ä¸€æ¬¡æ–°æ¶ˆæ¯

while True:
    msgs = wx.GetListenMessage()
    for chat in msgs:
        who = chat.who              # è·å–èŠå¤©çª—å£åï¼ˆäººæˆ–ç¾¤åï¼‰
        one_msgs = msgs.get(chat)   # è·å–æ¶ˆæ¯å†…å®¹
        for msg in one_msgs:
            msgtype = msg.type       # è·å–æ¶ˆæ¯ç±»å‹
            content = msg.content    # è·å–æ¶ˆæ¯å†…å®¹
            print(f'ã€{who}ã€‘ï¼š{content}')
            
            if msgtype == 'friend':
                chat.SendMsg('æ”¶åˆ°')  # å›å¤â€œæ”¶åˆ°â€
    time.sleep(wait)
```

> **æˆåŠŸæç¤º**ï¼šæ­å–œæ‚¨ï¼Œå·²ç»æˆåŠŸå®ç°äº†ä¸€ä¸ªç®€å•çš„å¾®ä¿¡æœºå™¨äººï¼Œèƒ½å¤Ÿè‡ªåŠ¨å›å¤æ¶ˆæ¯ï¼

---

## æ–¹æ³•è¯´æ˜

æœ¬èŠ‚è¯¦ç»†ä»‹ç» wxautox æä¾›çš„ä¸»è¦æ–¹æ³•åŠå…¶ä½¿ç”¨æ–¹æ³•ã€‚

### 1. ç›‘å¬

#### 1.1 æ·»åŠ ç›‘å¬å¯¹è±¡ `AddListenChat`

**æ–¹æ³•è¯´æ˜**ï¼š

`AddListenChat` æ–¹æ³•ç”¨äºæ·»åŠ éœ€è¦ç›‘å¬çš„èŠå¤©å¯¹è±¡ï¼ˆå¥½å‹æˆ–ç¾¤èŠï¼‰ï¼Œä»¥ä¾¿æ¥æ”¶å’Œå¤„ç†æ–°æ¶ˆæ¯ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°   | ç±»å‹        | é»˜è®¤å€¼ | è¯´æ˜                                     |
| ------ | ----------- | ------ | ---------------------------------------- |
| who    | `str`       | /      | è¦ç›‘å¬çš„å¯¹è±¡ï¼ˆå¥½å‹æˆ–ç¾¤èŠï¼‰çš„åç§°         |
| savepic| `bool`      | `False`| æ˜¯å¦ä¿å­˜æ–°æ¶ˆæ¯ä¸­çš„å›¾ç‰‡ï¼Œ`True` ä¿å­˜ï¼Œ`False` ä¸ä¿å­˜ |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è®¾ç½®ç›‘å¬åˆ—è¡¨
listen_list = [
    'å¼ ä¸‰',
    'æå››',
    'å·¥ä½œç¾¤A',
    'å·¥ä½œç¾¤B'
]

# æ·»åŠ ç›‘å¬å¯¹è±¡ï¼Œä¿å­˜æ–°æ¶ˆæ¯å›¾ç‰‡
for chat in listen_list:
    wx.AddListenChat(who=chat, savepic=True)
```

#### 1.2 è·å–ç›‘å¬æ¶ˆæ¯ `GetListenMessage`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetListenMessage` æ–¹æ³•ç”¨äºè·å–æ‰€æœ‰ç›‘å¬å¯¹è±¡çš„æ–°æ¶ˆæ¯ã€‚è¿”å›çš„æ•°æ®ç±»å‹ä¸ºå­—å…¸ï¼Œé”®ä¸ºç›‘å¬å¯¹è±¡ï¼Œå€¼ä¸ºæ¶ˆæ¯å¯¹è±¡åˆ—è¡¨ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                         |
| ---- | ------ | ------ | ---------------------------- |
| none | -      | -      | å½“å‰æ–¹æ³•ä¸æ¥å—ä»»ä½•å‚æ•°       |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–ç›‘å¬æ¶ˆæ¯å¹¶å¤„ç†
msgs = wx.GetListenMessage()
for chat in msgs:
    who = chat.who              # è·å–èŠå¤©çª—å£åï¼ˆäººæˆ–ç¾¤åï¼‰
    one_msgs = msgs.get(chat)   # è·å–æ¶ˆæ¯å†…å®¹
    for msg in one_msgs:
        msgtype = msg.type       # è·å–æ¶ˆæ¯ç±»å‹
        content = msg.content    # è·å–æ¶ˆæ¯å†…å®¹
        print(f'ã€{who}ã€‘ï¼š{content}')
        
        if msgtype == 'friend':
            chat.SendMsg('æ”¶åˆ°')  # å›å¤â€œæ”¶åˆ°â€
```

#### 1.3 ç§»é™¤ç›‘å¬å¯¹è±¡ `RemoveListenChat`

**æ–¹æ³•è¯´æ˜**ï¼š

`RemoveListenChat` æ–¹æ³•ç”¨äºç§»é™¤ä¸å†éœ€è¦ç›‘å¬çš„èŠå¤©å¯¹è±¡ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜                       |
| ---- | ---- | ------ | -------------------------- |
| who  | `str`| /      | è¦ç§»é™¤çš„ç›‘å¬å¯¹è±¡åç§°       |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# ç§»é™¤ä¸éœ€è¦ç›‘å¬çš„å¯¹è±¡
wx.RemoveListenChat(who='æå››')
```

#### 1.4 è·å–æ‰€æœ‰ç›‘å¬å¯¹è±¡ `GetAllListenChat`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetAllListenChat` æ–¹æ³•ç”¨äºè·å–å½“å‰æ‰€æœ‰è¢«ç›‘å¬çš„èŠå¤©å¯¹è±¡åˆ—è¡¨ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| ---- | ---- | ------ | ---- |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–æ‰€æœ‰ç›‘å¬å¯¹è±¡
listen_chats = wx.GetAllListenChat()
print(listen_chats)
# ç¤ºä¾‹è¾“å‡º: ['å¼ ä¸‰', 'å·¥ä½œç¾¤A', 'å·¥ä½œç¾¤B']
```

#### 1.5 ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªæ¶ˆæ¯å›å¤æœºå™¨äºº

ä»¥ä¸‹ç¤ºä¾‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ wxautox åˆ›å»ºä¸€ä¸ªç®€å•çš„æ¶ˆæ¯å›å¤æœºå™¨äººï¼Œèƒ½å¤Ÿè‡ªåŠ¨å›å¤ç‰¹å®šå¥½å‹æˆ–ç¾¤èŠçš„æ¶ˆæ¯ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat
import time

wx = WeChat()

# è®¾ç½®ç›‘å¬åˆ—è¡¨
listen_list = [
    'å¼ ä¸‰',
    'æå››',
    'å·¥ä½œç¾¤A',
    'å·¥ä½œç¾¤B'
]

# æ·»åŠ ç›‘å¬å¯¹è±¡ï¼Œä¿å­˜æ–°æ¶ˆæ¯å›¾ç‰‡
for chat in listen_list:
    wx.AddListenChat(who=chat, savepic=True)

wait = 1  # è®¾ç½®æ¯éš”1ç§’æ£€æŸ¥ä¸€æ¬¡æ–°æ¶ˆæ¯

while True:
    msgs = wx.GetListenMessage()
    for chat in msgs:
        who = chat.who              # è·å–èŠå¤©çª—å£åï¼ˆäººæˆ–ç¾¤åï¼‰
        one_msgs = msgs.get(chat)   # è·å–æ¶ˆæ¯å†…å®¹
        for msg in one_msgs:
            msgtype = msg.type       # è·å–æ¶ˆæ¯ç±»å‹
            content = msg.content    # è·å–æ¶ˆæ¯å†…å®¹
            print(f'ã€{who}ã€‘ï¼š{content}')
            
            if msgtype == 'friend':
                chat.SendMsg('æ”¶åˆ°')  # å›å¤â€œæ”¶åˆ°â€
    time.sleep(wait)
```

> **è¯´æ˜**ï¼š
> - **æ­¥éª¤ä¸€**ï¼šå®šä¹‰éœ€è¦ç›‘å¬çš„èŠå¤©å¯¹è±¡åˆ—è¡¨ã€‚
> - **æ­¥éª¤äºŒ**ï¼šé€šè¿‡ `AddListenChat` æ–¹æ³•æ·»åŠ ç›‘å¬å¯¹è±¡ï¼Œå¹¶é€‰æ‹©æ˜¯å¦ä¿å­˜å›¾ç‰‡ã€‚
> - **æ­¥éª¤ä¸‰**ï¼šä½¿ç”¨ä¸€ä¸ªæ— é™å¾ªç¯ä¸æ–­è°ƒç”¨ `GetListenMessage` æ–¹æ³•è·å–æ–°æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®æ¶ˆæ¯ç±»å‹è‡ªåŠ¨å›å¤ã€‚

---

### 2. å‘é€æ¶ˆæ¯

#### 2.1 å‘é€æ–‡å­—æ¶ˆæ¯ `SendMsg`

**æ–¹æ³•è¯´æ˜**ï¼š

`SendMsg` æ–¹æ³•ç”¨äºå‘é€æ–‡å­—æ¶ˆæ¯ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°   | ç±»å‹        | é»˜è®¤å€¼ | è¯´æ˜                                     |
| ------ | ----------- | ------ | ---------------------------------------- |
| msg    | `str`       | /      | è¦å‘é€çš„æ–‡å­—å†…å®¹                         |
| who    | `str`       | `None` | è¦å‘é€ç»™çš„å¯¹è±¡ï¼ˆå¥½å‹æˆ–ç¾¤èŠï¼‰ï¼Œé»˜è®¤ä¸ºå½“å‰æ‰“å¼€çš„èŠå¤©çª—å£ |
| clear  | `bool`      | `True` | æ˜¯å¦æ¸…é™¤åŸæœ¬èŠå¤©ç¼–è¾‘æ¡†çš„å†…å®¹             |
| at     | `list`/`str`| `None` | è¦ @ çš„äººï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªäººï¼Œä¾‹å¦‚ï¼š"å¼ ä¸‰" æˆ– ["å¼ ä¸‰", "æå››"] |
| exact  | `bool`      | `False`| æ˜¯å¦ç²¾ç¡®åŒ¹é… `who`ï¼Œé»˜è®¤ `False`         |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# å‘é€æ¶ˆæ¯ç»™æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹
msg = 'hello, wxautox!'
who = 'æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹'
wx.SendMsg(msg=msg, who=who)
```

**é™„å¸¦ @ ç¾¤å¥½å‹çš„æ¶ˆæ¯**

```python
from wxautox import WeChat

wx = WeChat()

msg = 'xxxxxxxï¼Œæ”¶åˆ°è¯·å›å¤ï¼'
who = 'å·¥ä½œç¾¤A'
at = ['å¼ ä¸‰', 'æå››']   # è¦ @ çš„äºº
wx.SendMsg(msg=msg, who=who, at=at)
```

#### 2.2 å‘é€æ‰“å­—æœºæ¨¡å¼æ¶ˆæ¯ `SendTypingText`

**æ–¹æ³•è¯´æ˜**ï¼š

`SendTypingText` æ–¹æ³•å¯æ¨¡æ‹Ÿæ‰“å­—æœºæ¨¡å¼é€å­—è¾“å…¥ï¼Œè¡Œä¸ºæ›´è´´è¿‘äººç±»ã€‚è¯¥æ–¹æ³•è¿˜æ”¯æŒæ¶ˆæ¯å†… @ ç¾¤å¥½å‹ï¼Œä¸å¿…åƒåŸæ¥ä¸€æ · @ å†…å®¹åªèƒ½å›ºå®šåœ¨æ–‡å­—å†…å®¹å‰é¢ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°   | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜                           |
| ------ | ---- | ------ | ------------------------------ |
| msg    | `str`| /      | è¦å‘é€çš„æ–‡æœ¬æ¶ˆæ¯               |
| who    | `str`| `None` | è¦å‘é€ç»™çš„å¯¹è±¡ï¼ˆå¥½å‹æˆ–ç¾¤èŠï¼‰ï¼Œé»˜è®¤ä¸ºå½“å‰æ‰“å¼€çš„èŠå¤©çª—å£ |
| clear  | `bool`| `True` | æ˜¯å¦æ¸…é™¤åŸæœ¬èŠå¤©ç¼–è¾‘æ¡†çš„å†…å®¹ |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
text = '''ä½ å¥½ï¼š
hello{@å¼ ä¸‰}ä½ å¥½{@æå››}ä¸‹åˆå¥½

é€šçŸ¥ï¼šxxxxxxx

å†è§'''
wx.SendTypingText(text)
```

![æ‰“å­—æœºæ¨¡å¼ç¤ºä¾‹](https://your-image-link.com/typing-mode.png) *(è¯·æ ¹æ®å®é™…é“¾æ¥ä¿®æ”¹)*

#### 2.3 å‘é€å›¾ç‰‡/è§†é¢‘/æ–‡ä»¶æ¶ˆæ¯ `SendFiles`

**æ–¹æ³•è¯´æ˜**ï¼š

`SendFiles` æ–¹æ³•ç”¨äºå‘é€å›¾ç‰‡ã€è§†é¢‘æˆ–æ–‡ä»¶ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°     | ç±»å‹          | é»˜è®¤å€¼ | è¯´æ˜                                     |
| -------- | ------------- | ------ | ---------------------------------------- |
| filepath | `str` / `list`| /      | æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œå•ä¸ªæ–‡ä»¶ä¸º `str`ï¼Œå¤šä¸ªæ–‡ä»¶ä¸º `list` |
| who      | `str`         | `None` | è¦å‘é€ç»™çš„å¯¹è±¡ï¼Œé»˜è®¤ä¸ºå½“å‰æ‰“å¼€çš„èŠå¤©çª—å£ |
| exact    | `bool`        | `False`| æ˜¯å¦ç²¾ç¡®åŒ¹é… `who`ï¼Œé»˜è®¤ `False`         |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# å‘é€å›¾ç‰‡ã€æ–‡ä»¶å’Œè§†é¢‘
files = [
    r'C:\Users\user\Desktop\1.jpg',   # å›¾ç‰‡
    r'C:\Users\user\Desktop\2.txt',   # æ–‡ä»¶
    r'C:\Users\user\Desktop\3.mp4'    # è§†é¢‘
]

who = 'æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹'
wx.SendFiles(filepath=files, who=who)
```

#### 2.4 å‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ… `SendEmotion`

**æ–¹æ³•è¯´æ˜**ï¼š

`SendEmotion` æ–¹æ³•ç”¨äºå‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ…ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°          | ç±»å‹  | é»˜è®¤å€¼ | è¯´æ˜                                 |
| ------------- | ----- | ------ | ------------------------------------ |
| emotion_index | `int` | /      | è¦å‘é€çš„ç´¢å¼•å€¼ï¼Œä» 0 å¼€å§‹ã€‚è‹¥ `emotion_index` å¤§äºç­‰äºè´¦å·å†…è‡ªå®šä¹‰è¡¨æƒ…æ•°é‡ï¼Œåˆ™å‘é€å¤±è´¥ï¼Œè¿”å› `False`ï¼ŒæˆåŠŸè¿”å› `True` |
| who           | `str` | `None` | è¦å‘é€ç»™çš„å¯¹è±¡ï¼Œé»˜è®¤ä¸ºå½“å‰æ‰“å¼€çš„èŠå¤©çª—å£ |
| exact         | `bool`| `False`| æ˜¯å¦ç²¾ç¡®åŒ¹é… `who`ï¼Œé»˜è®¤ `False`     |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
index = 0 
success = wx.SendEmotion(emotion_index=index) 
if success:
    print("è¡¨æƒ…å‘é€æˆåŠŸ")
else:
    print("è¡¨æƒ…å‘é€å¤±è´¥")
```

#### 2.5 æ¶ˆæ¯å…æ‰“æ‰° `MuteNotifications`

**æ–¹æ³•è¯´æ˜**ï¼š

`MuteNotifications` æ–¹æ³•ç”¨äºå¯¹å½“å‰èŠå¤©å¯¹è±¡å¼€å¯æˆ–å…³é—­æ¶ˆæ¯å…æ‰“æ‰°ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                     |
| ---- | ------ | ------ | ---------------------------------------- |
| mute | `bool` | `True` | å¯¹å½“å‰èŠå¤©å¯¹è±¡å¼€å¯æˆ–å…³é—­æ¶ˆæ¯å…æ‰“æ‰°ï¼Œ`True` å¼€å¯å…æ‰“æ‰°ï¼Œ`False` å…³é—­å…æ‰“æ‰° |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
group = 'å·¥ä½œç¾¤'
mute = True   # True ä¸ºå¼€å¯å…æ‰“æ‰°ï¼ŒFalse ä¸ºå…³é—­å…æ‰“æ‰°

# å…ˆæ‰“å¼€æŒ‡å®šèŠå¤©çª—å£ï¼Œå†æ‰§è¡Œå…æ‰“æ‰°æ“ä½œ
wx.ChatWith(group)
wx.MuteNotifications(mute=mute)
```

#### 2.6 é‚€è¯·å…¥ç¾¤ `AddGroupMembers`

**æ–¹æ³•è¯´æ˜**ï¼š

`AddGroupMembers` æ–¹æ³•ç”¨äºé‚€è¯·å¥½å‹åŠ å…¥ç¾¤èŠã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                      |
| ------- | ------ | ------ | ----------------------------------------- |
| group   | `str`  | /      | ç¾¤åæˆ–è€…ç¾¤å¤‡æ³¨å                          |
| members | `list` | /      | æˆå‘˜åˆ—è¡¨ï¼Œå¯ä»¥æ˜¯æ˜µç§°ã€å¤‡æ³¨åã€å¾®ä¿¡å·ï¼›æœ€å¥½æ˜¯å¾®ä¿¡å·æˆ–è€…å”¯ä¸€çš„å¤‡æ³¨å |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat
import time

wx = WeChat()

targets = [
    'å¥½å‹1',
    'å¥½å‹2',
    'å¥½å‹3'
]
group = 'wxautoxplusäº¤æµç¾¤'
wx.AddGroupMembers(group, targets)
```

#### 2.7 ä¼˜åŒ– `ChatWith` æ–¹æ³•

**æ–¹æ³•è¯´æ˜**ï¼š

ä¼˜åŒ–äº† `ChatWith` åŠå„ç§å‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œå¢åŠ  `exact` å‚æ•°ï¼Œç”¨äºåˆ¤æ–­åœ¨æœç´¢ `who` æ—¶æ˜¯å¦éœ€è¦ç²¾å‡†åŒ¹é…ï¼Œé»˜è®¤ä¸º `False`ï¼Œæ”¹ä¸º `True` åˆ™éœ€è¦ä¸€å­—ä¸å·®æ‰è¿›è¡Œå‘é€ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                   |
| ------- | ------ | ------ | -------------------------------------- |
| who     | `str`  | /      | è¦æ‰“å¼€çš„èŠå¤©çª—å£å¥½å‹åï¼›æœ€å¥½å®Œæ•´åŒ¹é…ï¼Œä¸å®Œå…¨åŒ¹é…åªä¼šé€‰å–æœç´¢æ¡†ç¬¬ä¸€ä¸ª |
| timeout | `int`  | `2`    | è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ 2 ç§’                     |
| exact   | `bool` | `False`| æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤ `False`             |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# ç²¾ç¡®åŒ¹é…èŠå¤©çª—å£
who = 'å¼ ä¸‰'
wx.ChatWith(who=who, exact=True)
```

#### 2.8 ä¿®æ”¹ç¾¤èŠåã€å¤‡æ³¨ã€ç¾¤å…¬å‘Šã€æˆ‘åœ¨æœ¬ç¾¤çš„æ˜µç§° `ManageGroup`

**æ–¹æ³•è¯´æ˜**ï¼š

`ManageGroup` æ–¹æ³•ç”¨äºä¿®æ”¹ç¾¤èŠçš„åç§°ã€å¤‡æ³¨ã€å…¬å‘Šä»¥åŠä¸ªäººåœ¨ç¾¤å†…çš„æ˜µç§°ï¼Œæˆ–é€‰æ‹©é€€å‡ºç¾¤èŠã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°     | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                           |
| -------- | ------ | ------ | ---------------------------------------------- |
| name     | `str`  | `None` | ä¿®æ”¹ç¾¤åç§°                                     |
| remark   | `str`  | `None` | ä¿®æ”¹å¤‡æ³¨å                                     |
| myname   | `str`  | `None` | ä¿®æ”¹æˆ‘çš„ç¾¤æ˜µç§°                                 |
| notice   | `str`  | `None` | ä¿®æ”¹ç¾¤å…¬å‘Š                                     |
| quit     | `bool` | `False`| æ˜¯å¦é€€å‡ºç¾¤ï¼Œå½“è¯¥é¡¹ä¸º `True` æ—¶ï¼Œå…¶ä»–å‚æ•°æ— æ•ˆ    |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
remark = 'å·¥ä½œç¾¤ï¼ˆä¸è¦å‘é”™ï¼‰'
result = wx.ManageGroup(remark=remark)
# è¿”å›å€¼ï¼šdict
# {
#     'remark': True   # å¦‚æœæœªæˆåŠŸåˆ™ä¸º False
# }
```

#### 2.9 ä¿®æ”¹å¥½å‹å¤‡æ³¨ã€å¢åŠ æ ‡ç­¾ `ManageFriend`

**æ–¹æ³•è¯´æ˜**ï¼š

`ManageFriend` æ–¹æ³•ç”¨äºä¿®æ”¹å¥½å‹çš„å¤‡æ³¨ååŠå¢åŠ æ ‡ç­¾ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                             |
| ------- | ------ | ------ | -------------------------------- |
| remark  | `str`  | `None` | ä¿®æ”¹å¤‡æ³¨å                       |
| tags    | `list` | `None` | è¦å¢åŠ çš„æ ‡ç­¾åˆ—è¡¨ï¼Œå¦‚ `['æœ‹å‹', 'åŒäº‹']` |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
remark = 'å¼ ä¸‰'
tags = ['åŒäº‹']
success = wx.ManageFriend(remark=remark, tags=tags)
# è¿”å›å€¼ï¼šboolï¼Œæ˜¯å¦æˆåŠŸä¿®æ”¹å¤‡æ³¨åæˆ–æ ‡ç­¾

if success:
    print("å¥½å‹å¤‡æ³¨å’Œæ ‡ç­¾ä¿®æ”¹æˆåŠŸ")
else:
    print("å¥½å‹å¤‡æ³¨å’Œæ ‡ç­¾ä¿®æ”¹å¤±è´¥")
```

#### 2.10 è‡ªåŠ¨ä¿å­˜æ¶ˆæ¯å†…çš„å¡ç‰‡é“¾æ¥ `parseurl` å‚æ•°

ä»¥ä¸‹æ–¹æ³•å¢åŠ  `parseurl` å‚æ•°ï¼Œç”¨äºè‡ªåŠ¨è§£ææ¶ˆæ¯å†…å¡ç‰‡æ¶ˆæ¯çš„ URL é“¾æ¥ï¼š

- `GetAllMessage`
- `GetListenMessage`
- `GetAllNewMessage`
- `GetNextNewMessage`
- `AddListenChat`

**ç¤ºä¾‹ä»£ç **ï¼š

```python
msgs = wx.GetAllMessage(parseurl=True)
# å¡ç‰‡é“¾æ¥è§£æåçš„æ ¼å¼ä¸ºï¼š
# "[wxautoxå¡ç‰‡é“¾æ¥è§£æ]https://xxxxxxx"
# [
#     ...
#     ['Time', '13:34'],
#     ['Self', '[wxautoxå¡ç‰‡é“¾æ¥è§£æ]https://mp.weixin.qq.com/s/x8ilebSF5_KYd0PloyZm-Q']
# ]
```

#### 2.11 è·å–å½“å‰èŠå¤©çª—å£è¯¦æƒ… `CurrentChat` æ–¹æ³•å¢åŠ  `details` å‚æ•°

**æ–¹æ³•è¯´æ˜**ï¼š

`CurrentChat` æ–¹æ³•ç”¨äºè·å–å½“å‰èŠå¤©çª—å£çš„è¯¦ç»†ä¿¡æ¯ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹  | é»˜è®¤å€¼ | è¯´æ˜                                      |
| ------- | ----- | ------ | ----------------------------------------- |
| details | `bool`| `False`| æ˜¯å¦è·å–è¯¦ç»†ä¿¡æ¯ï¼Œ`True` è·å–ï¼Œ`False` ä¸è·å– |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
details = wx.CurrentChat(details=True)
print(details)
# ç¤ºä¾‹è¾“å‡º:
# {
#     'chat_type': 'group', 
#     'chat_name': 'wxautoxå››ç¾¤', 
#     'group_member_count': 490
# }
```

**è¿”å›å€¼è¯´æ˜**ï¼š

| é”®                 | è¯´æ˜                                                           |
| ------------------ | -------------------------------------------------------------- |
| id                 | æ¶ˆæ¯çš„ UI æ§ä»¶æå–åˆ°çš„ runtimeidï¼Œå”¯ä¸€ï¼Œä¸ç”¨å¯å¿½ç•¥             |
| type               | æ¶ˆæ¯ç±»å‹ï¼Œ`friend` ä¸ºå…¶ä»–äººå‘çš„æ¶ˆæ¯ï¼Œ`time` æ—¶é—´æ¶ˆæ¯ï¼Œ`sys` ç³»ç»Ÿæ¶ˆæ¯ï¼Œ`self` è‡ªå·±å‘çš„æ¶ˆæ¯ |
| sender             | æ¶ˆæ¯å‘é€äººçš„æ˜µç§°                                               |
| content            | æ¶ˆæ¯å†…å®¹                                                       |
| sender_remark      | æ¶ˆæ¯å‘é€äººçš„å¤‡æ³¨ï¼Œæ²¡æœ‰åˆ™ä¸º `None`                              |
| chat_type          | èŠå¤©ç±»å‹ï¼Œ`group` ä¸ºç¾¤èŠï¼Œ`friend` ä¸ºå¥½å‹èŠå¤©ï¼Œ`official` ä¸ºå…¬ä¼—å· |
| chat_name          | å½“å‰èŠå¤©å¯¹è±¡åï¼Œç¾¤åæˆ–å¥½å‹å                                     |
| group_member_count | ç¾¤èŠäººæ•°ï¼Œå¦‚æœæ˜¯ç¾¤æ¶ˆæ¯åˆ™æœ‰è¯¥å‚æ•°                               |

---

### 3. è·å–æ¶ˆæ¯

#### 3.1 è·å–å½“å‰èŠå¤©çª—å£æ‰€æœ‰æ¶ˆæ¯ `GetAllMessage`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetAllMessage` æ–¹æ³•ç”¨äºè·å–å½“å‰èŠå¤©çª—å£çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œè¿”å›æ¶ˆæ¯å¯¹è±¡åˆ—è¡¨ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°      | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                     |
| --------- | ------ | ------ | ---------------------------------------- |
| savepic   | `bool` | `False` | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©å›¾ç‰‡                     |
| savefile  | `bool` | `False` | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©æ–‡ä»¶                     |
| savevoice | `bool` | `False` | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©è¯­éŸ³è½¬æ–‡å­—å†…å®¹           |
| parseurl  | `bool` | `False` | æ˜¯å¦è‡ªåŠ¨è§£ææ¶ˆæ¯ä¸­çš„URLé“¾æ¥               |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–å½“å‰èŠå¤©çª—å£æ¶ˆæ¯å¹¶ä¿å­˜å›¾ç‰‡ã€æ–‡ä»¶åŠè¯­éŸ³è½¬æ–‡å­—å†…å®¹ï¼Œå¹¶è§£æURL
msgs = wx.GetAllMessage(
    savepic=True,    # ä¿å­˜å›¾ç‰‡
    savefile=True,   # ä¿å­˜æ–‡ä»¶
    savevoice=True,  # ä¿å­˜è¯­éŸ³è½¬æ–‡å­—å†…å®¹
    parseurl=True    # è§£æURLé“¾æ¥
)

# è¾“å‡ºæ¶ˆæ¯å†…å®¹
for msg in msgs:
    if msg.type == 'sys':
        print(f'ã€ç³»ç»Ÿæ¶ˆæ¯ã€‘{msg.content}')
    elif msg.type == 'friend':
        sender = msg.sender  # å¯æ›¿æ¢ä¸º msg.sender_remark è·å–å¤‡æ³¨å
        print(f'{sender.rjust(20)}ï¼š{msg.content}')
    elif msg.type == 'self':
        print(f'{msg.sender.ljust(20)}ï¼š{msg.content}')
    elif msg.type == 'time':
        print(f'\nã€æ—¶é—´æ¶ˆæ¯ã€‘{msg.time}')
    elif msg.type == 'recall':
        print(f'ã€æ’¤å›æ¶ˆæ¯ã€‘{msg.content}')
```

> **æ³¨æ„**ï¼šè‡ªåŠ¨ä¿å­˜æ–‡ä»¶åŠŸèƒ½åœ¨å¤„ç†å¤§æ–‡ä»¶æ—¶å¯èƒ½å­˜åœ¨ BUGã€‚

#### 3.2 åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯ `LoadMoreMessage`

**æ–¹æ³•è¯´æ˜**ï¼š

`LoadMoreMessage` æ–¹æ³•ç”¨äºåŠ è½½æ›´å¤šå†å²æ¶ˆæ¯ï¼Œéœ€é…åˆ `GetAllMessage` æ–¹æ³•ä½¿ç”¨ï¼Œä»¥è·å–æ›´å¤šå†å²æ¶ˆæ¯ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯
wx.LoadMoreMessage()

# è·å–å½“å‰èŠå¤©çª—å£æ¶ˆæ¯
msgs = wx.GetAllMessage()
# æ ¹æ®éœ€è¦è‡ªè¡Œæ„å»ºæ¶ˆæ¯å¤„ç†é€»è¾‘
```

> **æç¤º**ï¼š`LoadMoreMessage` æ–¹æ³•åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯æ—¶ï¼Œéœ€ç¡®ä¿å½“å‰èŠå¤©çª—å£å­˜åœ¨å†å²æ¶ˆæ¯ï¼Œå¦åˆ™è°ƒç”¨æ— æ•ˆã€‚

#### 3.3 è·å–æ–°æ¶ˆæ¯

##### 3.3.1 è·å–ä¸»çª—å£æ–°æ¶ˆæ¯

- **`GetAllNewMessage`**ï¼šè·å–æ‰€æœ‰æ–°æ¶ˆæ¯ã€‚
- **`GetNextNewMessage`**ï¼šè·å–ä¸‹ä¸€æ¡æ–°æ¶ˆæ¯ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–æ‰€æœ‰æ–°æ¶ˆæ¯
msgs = wx.GetAllNewMessage()

# è·å–ä¸‹ä¸€æ¡æ–°æ¶ˆæ¯
next_msg = wx.GetNextNewMessage()
```

> **æ³¨æ„**ï¼š`GetAllNewMessage` å’Œ `GetNextNewMessage` è¿”å›çš„æ•°æ®ç±»å‹å‡ä¸ºå­—å…¸ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```python
{
    'å¼ ä¸‰': [msg1, msg2, ...],
    'æå››': [msg1, msg2, ...],
    ...
}
```

##### 3.3.2 ç›‘å¬æ¶ˆæ¯ `GetListenMessage`

åœ¨è°ƒç”¨ `AddListenChat` æ–¹æ³•æ·»åŠ ç›‘å¬å¯¹è±¡åï¼Œé€šè¿‡ `GetListenMessage` æ–¹æ³•è·å–ç›‘å¬æ¶ˆæ¯ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è®¾ç½®ç›‘å¬åˆ—è¡¨
listen_list = [
    'å¼ ä¸‰',
    'æå››',
    'å·¥ä½œç¾¤A',
    'å·¥ä½œç¾¤B'
]

# æ·»åŠ ç›‘å¬å¯¹è±¡ï¼Œä¿å­˜æ–°æ¶ˆæ¯å›¾ç‰‡
for chat in listen_list:
    wx.AddListenChat(who=chat, savepic=True)

# è·å–ç›‘å¬æ¶ˆæ¯å¹¶å›å¤
msgs = wx.GetListenMessage()
for chat in msgs:
    one_msgs = msgs.get(chat)  # è·å–æ¶ˆæ¯å†…å®¹
    for msg in one_msgs:
        if msg.type == 'friend':
            sender = msg.sender  # å¯æ›¿æ¢ä¸º msg.sender_remark è·å–å¤‡æ³¨å
            print(f'{sender.rjust(20)}ï¼š{msg.content}')
            chat.SendMsg('æ”¶åˆ°')  # å›å¤â€œæ”¶åˆ°â€
```

> **æç¤º**ï¼š`GetListenMessage` æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œé”®ä¸ºç›‘å¬å¯¹è±¡ï¼Œå€¼ä¸ºæ¶ˆæ¯å¯¹è±¡åˆ—è¡¨ã€‚

---

### 4. æ·»åŠ å¥½å‹

#### 4.1 å‘èµ·å¥½å‹ç”³è¯· `AddNewFriend`

**æ–¹æ³•è¯´æ˜**ï¼š

`AddNewFriend` æ–¹æ³•ç”¨äºå‘èµ·å¥½å‹ç”³è¯·ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°      | ç±»å‹        | é»˜è®¤å€¼            | è¯´æ˜                                     |
| --------- | ----------- | ----------------- | ---------------------------------------- |
| keywords  | `str`       | /                 | å¾®ä¿¡å·ã€æ‰‹æœºå·ã€QQå·                      |
| addmsg    | `str`       | `'ä½ å¥½ï¼Œæˆ‘æ˜¯xxxx'` | æ·»åŠ å¥½å‹çš„æ¶ˆæ¯                            |
| remark    | `str`       | `None`            | å¤‡æ³¨å                                   |
| tags      | `list`      | `None`            | æ ‡ç­¾åˆ—è¡¨ï¼Œå¦‚ `['æœ‹å‹', 'åŒäº‹']`             |
| permission| `str`       | `'æœ‹å‹åœˆ'`        | æƒé™è®¾ç½®ï¼Œ`'æœ‹å‹åœˆ'` æˆ– `'ä»…èŠå¤©'`        |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

keywords = '13800000000'      # å¾®ä¿¡å·ã€æ‰‹æœºå·ã€QQå·
addmsg = 'ä½ å¥½ï¼Œæˆ‘æ˜¯xxxx'      # æ·»åŠ å¥½å‹çš„æ¶ˆæ¯
remark = 'å¤‡æ³¨åå­—'            # å¤‡æ³¨åï¼Œæ— åˆ™æ— éœ€è®¾ç½®
tags = ['æœ‹å‹', 'åŒäº‹']        # æ ‡ç­¾åˆ—è¡¨

# å‘èµ·å¥½å‹ç”³è¯·
wx.AddNewFriend(keywords, addmsg=addmsg, remark=remark, tags=tags, permission='æœ‹å‹åœˆ')
```

#### 4.2 æ¥å—å¥½å‹è¯·æ±‚

##### 4.2.1 è·å–æ–°çš„å¥½å‹ç”³è¯·å¯¹è±¡åˆ—è¡¨ `GetNewFriends`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetNewFriends` æ–¹æ³•ç”¨äºè·å–æ–°çš„å¥½å‹ç”³è¯·å¯¹è±¡åˆ—è¡¨ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

new_friends = wx.GetNewFriends()
# ç¤ºä¾‹è¾“å‡º:
# [<wxautox New Friends Element at 0x1e95fced080 (å¼ ä¸‰: ä½ å¥½,æˆ‘æ˜¯xxxç¾¤çš„å¼ ä¸‰)>,
#  <wxautox New Friends Element at 0x1e95fced081 (æå››: ä½ å¥½,æˆ‘æ˜¯xxxç¾¤çš„æå››)>]
```

##### 4.2.2 é€šè¿‡å¥½å‹ç”³è¯·å¯¹è±¡æ¥å—å¥½å‹è¯·æ±‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# è·å–ç¬¬ä¸€ä¸ªå¯æ¥å—çš„æ–°å¥½å‹å¯¹è±¡
new_friend1 = new_friends[0]

print(new_friend1.name)  # è·å–å¥½å‹ç”³è¯·æ˜µç§°
# è¾“å‡º: å¼ ä¸‰

print(new_friend1.msg)   # è·å–å¥½å‹ç”³è¯·ä¿¡æ¯
# è¾“å‡º: ä½ å¥½,æˆ‘æ˜¯xxxç¾¤çš„å¼ ä¸‰

# æ¥å—å¥½å‹è¯·æ±‚ï¼Œå¹¶æ·»åŠ å¤‡æ³¨â€œå¤‡æ³¨å¼ ä¸‰â€åŠæ ‡ç­¾â€œwxautoxâ€
new_friend1.Accept(remark='å¤‡æ³¨å¼ ä¸‰', tags=['wxautox'])

# åˆ‡æ¢å›èŠå¤©é¡µé¢
wx.SwitchToChat()
```

> **æç¤º**ï¼šæ¥å—å¥½å‹è¯·æ±‚åï¼Œéœ€è°ƒç”¨ `SwitchToChat` æ–¹æ³•åˆ‡æ¢å›èŠå¤©é¡µé¢ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨å…¶ä»–èŠå¤©ç›¸å…³çš„æ–¹æ³•ã€‚

---

### 5. åˆ‡æ¢èŠå¤©çª—å£

#### 5.1 åˆ‡æ¢åˆ°æŒ‡å®šå¥½å‹èŠå¤©æ¡† `ChatWith`

**æ–¹æ³•è¯´æ˜**ï¼š

`ChatWith` æ–¹æ³•ç”¨äºåˆ‡æ¢åˆ°æŒ‡å®šå¥½å‹æˆ–ç¾¤èŠçš„èŠå¤©çª—å£ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                   |
| ------- | ------ | ------ | -------------------------------------- |
| who     | `str`  | /      | è¦æ‰“å¼€çš„èŠå¤©çª—å£å¥½å‹åæˆ–ç¾¤å           |
| timeout | `int`  | `2`    | è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ 2 ç§’                     |
| exact   | `bool` | `False`| æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤ `False`             |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# åˆ‡æ¢åˆ°æŒ‡å®šå¥½å‹èŠå¤©æ¡†
who = 'å¼ ä¸‰'
wx.ChatWith(who=who, exact=True)
```

#### 5.2 åˆ‡æ¢å¾®ä¿¡ä¸»é¡µé¢

é€šè¿‡ç‚¹å‡»å¾®ä¿¡å·¦ä¾§é»‘è‰²ä¾§è¾¹æ çš„ç›¸åº”å›¾æ ‡æŒ‰é’®ï¼Œå®ç°é¡µé¢åˆ‡æ¢ã€‚

##### 5.2.1 åˆ‡æ¢åˆ°èŠå¤©é¡µé¢ `SwitchToChat`

```python
from wxautox import WeChat

wx = WeChat()

# åˆ‡æ¢åˆ°èŠå¤©é¡µé¢
wx.SwitchToChat()
```

##### 5.2.2 åˆ‡æ¢åˆ°é€šè®¯å½•é¡µé¢ `SwitchToContact`

```python
from wxautox import WeChat

wx = WeChat()

# åˆ‡æ¢åˆ°é€šè®¯å½•é¡µé¢
wx.SwitchToContact()
```

---

### 6. è·å–å¥½å‹ä¿¡æ¯

#### 6.1 è·å–ç²—ç•¥ä¿¡æ¯ `GetAllFriends`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetAllFriends` æ–¹æ³•ç”¨äºè·å–æ‰€æœ‰å¥½å‹çš„åŸºæœ¬ä¿¡æ¯ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°      | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                     |
| --------- | ------ | ------ | ---------------------------------------- |
| keywords  | `str`  | `None` | æœç´¢å…³é”®è¯ï¼Œåªè¿”å›åŒ…å«å…³é”®è¯çš„å¥½å‹åˆ—è¡¨   |
| speed     | `int`  | `5`    | æ»šåŠ¨é€Ÿåº¦ï¼Œæ•°å€¼è¶Šå¤§æ»šåŠ¨è¶Šå¿«ï¼Œä½†å¯èƒ½é—æ¼ï¼Œå»ºè®® 1-5 |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

friend_infos = wx.GetAllFriends()
# ç¤ºä¾‹è¾“å‡º:
# [
#     {'nickname': 'å¼ ä¸‰', 'remark': 'å¼ æ€»', 'tags': None},
#     {'nickname': 'æå››', 'remark': None, 'tags': ['åŒäº‹', 'åˆä¸­åŒå­¦']},
#     {'nickname': 'ç‹äº”', 'remark': None, 'tags': None},
#     ...
# ]
```

> **æ³¨æ„**ï¼šè¯¥æ–¹æ³•çš„è¿è¡Œæ—¶é—´å–å†³äºå¥½å‹æ•°é‡ï¼Œçº¦ä¸ºæ¯ç§’ 6-8 ä¸ªå¥½å‹çš„é€Ÿåº¦ã€‚æœªç»è¿‡å¤§é‡æµ‹è¯•ï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥é—®é¢˜ï¼Œå¦‚æœ‰é—®é¢˜è¯·åœ¨å¾®ä¿¡ç¾¤å†…åé¦ˆã€‚

#### 6.2 è·å–è¯¦ç»†ä¿¡æ¯ `GetAllFriendDetails`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetAllFriendDetails` æ–¹æ³•ç”¨äºè·å–å¥½å‹çš„è¯¦ç»†ä¿¡æ¯ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹ | é»˜è®¤å€¼    | è¯´æ˜                                                           |
| ------- | ---- | --------- | -------------------------------------------------------------- |
| n       | `int`| `None`    | è·å–å‰ `n` ä¸ªå¥½å‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œé»˜è®¤ä¸º `None`ï¼Œå³è·å–æ‰€æœ‰å¥½å‹çš„è¯¦ç»†ä¿¡æ¯ |
| timeout | `int`| `0xFFFFF` | è·å–å¥½å‹è¯¦ç»†ä¿¡æ¯çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’                           |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–æ‰€æœ‰å¥½å‹çš„è¯¦ç»†ä¿¡æ¯
friend_details = wx.GetAllFriendDetails()

# ç¤ºä¾‹è¾“å‡º:
# [
#     {
#         'å¾®ä¿¡å·ï¼š': 'abc123456',
#         'åœ°åŒºï¼š': 'ä¸Šæµ· æµ¦ä¸œæ–°åŒº',
#         'å¤‡æ³¨': '',
#         'æ ‡ç­¾': 'wxautox',
#         'å…±åŒç¾¤èŠ': '1ä¸ª',
#         'æ¥æº': 'é€šè¿‡æ‰«ä¸€æ‰«æ·»åŠ ',
#         'æ˜µç§°': 'å¼ ä¸‰'
#     },
#     {
#         'å¤‡æ³¨': '',
#         'ä¼ä¸š': 'å¹¿å·èåˆ›æ–‡æ—…åŸ',
#         'å®å': '***',
#         'å®˜æ–¹å•†åŸ': 'ğŸ«è´­æ»‘é›ªç¥¨å…¥å£ğŸ«',
#         'é€šçŸ¥': 'å›å¤æ—¶é—´ä¸ºå·¥ä½œæ—¥9ç‚¹-18ç‚¹',
#         'ä¼šå‘˜å•†åŸ': 'ğŸ‚çƒ­é›ªå€¼å…‘æ¢é›ªç¥¨ğŸ‚',
#         'å†°ç®±èµæ»‘': 'ğŸ‘¬ç”³è¯·å†°ç®±ä¸»ç†äººğŸ‘­',
#         'å…¨æ°‘æ»‘é›ª': 'è´­ç¥¨èµ¢é»„é‡‘ä¼šç±',
#         'å…±åŒç¾¤èŠ': '1ä¸ª',
#         'æ˜µç§°': 'å¹¿å·å¤§å†°ç®±'
#     },
#     ...
# ]
```

> **æ³¨æ„**ï¼š
> - è¯¥æ–¹æ³•çš„è¿è¡Œæ—¶é—´è¾ƒé•¿ï¼Œçº¦ä¸º 0.5-1 ç§’è·å–ä¸€ä¸ªå¥½å‹çš„è¯¦ç»†ä¿¡æ¯ã€‚è‹¥å¥½å‹æ•°é‡è¾ƒå¤šï¼Œå¯é€šè¿‡è®¾ç½® `n` æˆ– `timeout` å‚æ•°ä»¥åŠ å¿«è·å–é€Ÿåº¦ã€‚
> - è‹¥é‡åˆ°ä¼ä¸šå¾®ä¿¡çš„å¥½å‹ä¸”å¤„äºå·²ç¦»èŒçŠ¶æ€ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾®ä¿¡å®¢æˆ·ç«¯å¡æ­»ï¼Œéœ€é‡å¯ï¼ˆæ­¤ä¸ºå¾®ä¿¡å®¢æˆ·ç«¯ BUGï¼‰ã€‚
> - è¯¥æ–¹æ³•æœªç»è¿‡å¤§é‡æµ‹è¯•ï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥é—®é¢˜ï¼Œå¦‚æœ‰é—®é¢˜è¯·åœ¨å¾®ä¿¡ç¾¤å†…åé¦ˆã€‚

#### 6.3 è·å–æ‰€æœ‰å¥½å‹è¯¦æƒ… `GetFriendDetails`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetFriendDetails` æ–¹æ³•ç”¨äºè·å–æ‰€æœ‰å¥½å‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œç±»ä¼¼äº `GetAllFriendDetails`ï¼Œä½†æä¾›äº†æ›´é«˜çš„çµæ´»æ€§å’Œæ§åˆ¶ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°    | ç±»å‹ | é»˜è®¤å€¼    | è¯´æ˜                                                           |
| ------- | ---- | --------- | -------------------------------------------------------------- |
| n       | `int`| `None`    | è·å–å‰ `n` ä¸ªå¥½å‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œé»˜è®¤ä¸º `None`ï¼Œå³è·å–æ‰€æœ‰å¥½å‹çš„è¯¦ç»†ä¿¡æ¯ |
| timeout | `int`| `0xFFFFF` | è·å–å¥½å‹è¯¦ç»†ä¿¡æ¯çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’                           |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–æ‰€æœ‰å¥½å‹çš„è¯¦ç»†ä¿¡æ¯
friend_details = wx.GetFriendDetails()

# ç¤ºä¾‹è¾“å‡º:
# [
#     {
#         'å¾®ä¿¡å·': 'abc123456',
#         'åœ°åŒº': 'ä¸Šæµ· æµ¦ä¸œæ–°åŒº',
#         'å¤‡æ³¨': '',
#         'æ ‡ç­¾': 'wxautox',
#         'å…±åŒç¾¤èŠ': '1ä¸ª',
#         'æ¥æº': 'é€šè¿‡æ‰«ä¸€æ‰«æ·»åŠ ',
#         'æ˜µç§°': 'å¼ ä¸‰'
#     },
#     {
#         'å¤‡æ³¨': '',
#         'ä¼ä¸š': 'å¹¿å·èåˆ›æ–‡æ—…åŸ',
#         'å®å': '***',
#         'å®˜æ–¹å•†åŸ': 'ğŸ«è´­æ»‘é›ªç¥¨å…¥å£ğŸ«',
#         'é€šçŸ¥': 'å›å¤æ—¶é—´ä¸ºå·¥ä½œæ—¥9ç‚¹-18ç‚¹',
#         'ä¼šå‘˜å•†åŸ': 'ğŸ‚çƒ­é›ªå€¼å…‘æ¢é›ªç¥¨ğŸ‚',
#         'å†°ç®±èµæ»‘': 'ğŸ‘¬ç”³è¯·å†°ç®±ä¸»ç†äººğŸ‘­',
#         'å…¨æ°‘æ»‘é›ª': 'è´­ç¥¨èµ¢é»„é‡‘ä¼šç±',
#         'å…±åŒç¾¤èŠ': '1ä¸ª',
#         'æ˜µç§°': 'å¹¿å·å¤§å†°ç®±'
#     },
#     ...
# ]
```

---

## å¯¹è±¡è¯´æ˜

æœ¬èŠ‚ä»‹ç» wxautox ä¸­çš„ä¸»è¦å¯¹è±¡åŠå…¶å±æ€§å’Œæ–¹æ³•ã€‚

### 1. æ¶ˆæ¯å¯¹è±¡

æ¶ˆæ¯å¯¹è±¡æ˜¯é€šè¿‡è°ƒç”¨ `GetAllMessage`ã€`GetListenMessage` ç­‰æ–¹æ³•è¿”å›çš„å¯¹è±¡ï¼ŒåŒ…å«äº†æ¶ˆæ¯çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¶ˆæ¯ç±»å‹ã€å†…å®¹ã€å‘é€è€…ç­‰ã€‚æ¶ˆæ¯ç±»å‹ä¸»è¦åŒ…æ‹¬ç³»ç»Ÿæ¶ˆæ¯ã€æ—¶é—´æ¶ˆæ¯ã€æ’¤å›æ¶ˆæ¯ã€å¥½å‹æ¶ˆæ¯å’Œè‡ªå·±çš„æ¶ˆæ¯ã€‚

#### 1.1 ç³»ç»Ÿæ¶ˆæ¯

**å±æ€§**ï¼š

| å±æ€§å | ç±»å‹                     | è¯´æ˜                           |
| ------ | ------------------------ | ------------------------------ |
| type   | `str`                    | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º `sys`         |
| content| `str`                    | æ¶ˆæ¯å†…å®¹                         |
| sender | `str`                    | å‘é€è€…ï¼Œå›ºå®šä¸º `SYS`             |
| info   | `list`                   | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯       |
| control| `uiautomation.Control`   | æ¶ˆæ¯çš„ UIAutomation æ§ä»¶        |
| id     | `str`                    | æ¶ˆæ¯ ID                         |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
msgs = wx.GetAllMessage()
for msg in msgs:
    if msg.type == 'sys':
        print(f'ã€ç³»ç»Ÿæ¶ˆæ¯ã€‘{msg.content}')
```

#### 1.2 æ—¶é—´æ¶ˆæ¯

**å±æ€§**ï¼š

| å±æ€§å | ç±»å‹                     | è¯´æ˜                                   |
| ------ | ------------------------ | -------------------------------------- |
| type   | `str`                    | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º `time`                 |
| content| `str`                    | æ¶ˆæ¯å†…å®¹                                 |
| sender | `str`                    | å‘é€è€…ï¼Œå›ºå®šä¸º `Time`                   |
| time   | `str`                    | æ—¶é—´æ¶ˆæ¯å†…å®¹ï¼Œæ ¼å¼ä¸º `%Y-%m-%d %H:%M`    |
| info   | `list`                   | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯             |
| control| `uiautomation.Control`   | æ¶ˆæ¯çš„ UIAutomation æ§ä»¶        |
| id     | `str`                    | æ¶ˆæ¯ ID                                 |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
msgs = wx.GetAllMessage()
for msg in msgs:
    if msg.type == 'time':
        print(f'ã€æ—¶é—´æ¶ˆæ¯ã€‘{msg.time}')
```

#### 1.3 æ’¤å›æ¶ˆæ¯

**å±æ€§**ï¼š

| å±æ€§å | ç±»å‹                     | è¯´æ˜                                 |
| ------ | ------------------------ | ------------------------------------ |
| type   | `str`                    | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º `recall`             |
| content| `str`                    | æ¶ˆæ¯å†…å®¹                               |
| sender | `str`                    | å‘é€è€…ï¼Œå›ºå®šä¸º `Recall`               |
| info   | `list`                   | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯           |
| control| `uiautomation.Control`   | æ¶ˆæ¯çš„ UIAutomation æ§ä»¶        |
| id     | `str`                    | æ¶ˆæ¯ ID                               |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
msgs = wx.GetAllMessage()
for msg in msgs:
    if msg.type == 'recall':
        print(f'ã€æ’¤å›æ¶ˆæ¯ã€‘{msg.content}')
```

#### 1.4 å¥½å‹æ¶ˆæ¯

**å±æ€§**ï¼š

| å±æ€§å        | ç±»å‹                     | è¯´æ˜                                     |
| ------------- | ------------------------ | ---------------------------------------- |
| type          | `str`                    | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º `friend`                 |
| content       | `str`                    | æ¶ˆæ¯å†…å®¹                                 |
| sender        | `str`                    | å‘é€è€…                                   |
| sender_remark | `str`                    | å‘é€è€…å¤‡æ³¨å                             |
| info          | `list`                   | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯               |
| control       | `uiautomation.Control`   | æ¶ˆæ¯çš„ UIAutomation æ§ä»¶        |
| id            | `str`                    | æ¶ˆæ¯ ID                                 |

**æ”¯æŒæ–¹æ³•**ï¼š

| æ–¹æ³•å      | è¯´æ˜                                                         |
| ----------- | ------------------------------------------------------------ |
| quote       | å¼•ç”¨æ¶ˆæ¯è¿›è¡Œå›å¤ï¼Œå‚æ•°ä¸ºå›å¤å†…å®¹ `str`                         |
| forward     | è½¬å‘æ¶ˆæ¯ï¼Œå‚æ•°ä¸ºå¥½å‹å `str`                                   |
| parse       | è§£æåˆå¹¶æ¶ˆæ¯å†…å®¹ï¼Œä»…åœ¨åˆå¹¶è½¬å‘æ¶ˆæ¯æ—¶æœ‰æ•ˆï¼Œè¿”å›åˆ—è¡¨             |
| add_friend  | æ·»åŠ å¥½å‹ï¼Œå‚æ•°åŒ…æ‹¬ `addmsg`, `remark`, `tags`, `permission`   |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
msgs = wx.GetAllMessage()
for msg in msgs[::-1]:
    if msg.type == 'friend':
        sender = msg.sender  # å¯æ›¿æ¢ä¸º msg.sender_remark è·å–å¤‡æ³¨å
        print(f'{sender}ï¼š{msg.content}')
        msg.quote('å›å¤æ¶ˆæ¯')  # å¼•ç”¨æ¶ˆæ¯è¿›è¡Œå›å¤
        # æ·»åŠ å¥½å‹ç¤ºä¾‹
        msg.add_friend(addmsg='ä½ å¥½ï¼', remark='æ–°æœ‹å‹', tags=['åŒäº‹'], permission='ä»…èŠå¤©')
        break
```

#### 1.5 è‡ªå·±çš„æ¶ˆæ¯

**å±æ€§**ï¼š

| å±æ€§å | ç±»å‹                     | è¯´æ˜                           |
| ------ | ------------------------ | ------------------------------ |
| type   | `str`                    | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º `self`         |
| content| `str`                    | æ¶ˆæ¯å†…å®¹                         |
| sender | `str`                    | å‘é€è€…                           |
| info   | `list`                   | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯       |
| control| `uiautomation.Control`   | æ¶ˆæ¯çš„ UIAutomation æ§ä»¶        |
| id     | `str`                    | æ¶ˆæ¯ ID                         |

**æ”¯æŒæ–¹æ³•**ï¼š

| æ–¹æ³•å | è¯´æ˜                                                         |
| ------ | ------------------------------------------------------------ |
| quote  | å¼•ç”¨æ¶ˆæ¯è¿›è¡Œå›å¤ï¼Œå‚æ•°ä¸ºå›å¤å†…å®¹ `str`                         |
| forward| è½¬å‘æ¶ˆæ¯ï¼Œå‚æ•°ä¸ºå¥½å‹å `str`                                   |
| parse  | è§£æåˆå¹¶æ¶ˆæ¯å†…å®¹ï¼Œä»…åœ¨åˆå¹¶è½¬å‘æ¶ˆæ¯æ—¶æœ‰æ•ˆï¼Œè¿”å›åˆ—è¡¨             |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
msgs = wx.GetAllMessage()
for msg in msgs[::-1]:
    if msg.type == 'self':
        print(f'{msg.sender}ï¼š{msg.content}')
        msg.quote('å›å¤æ¶ˆæ¯')  # å¼•ç”¨æ¶ˆæ¯è¿›è¡Œå›å¤
        break
```

---

### 2. èŠå¤©çª—å£å¯¹è±¡

èŠå¤©çª—å£å¯¹è±¡æŒ‡åœ¨ç›‘å¬æ¶ˆæ¯æ¨¡å¼ä¸‹æ‰“å¼€çš„ç‹¬ç«‹èŠå¤©çª—å£ï¼Œç”¨äºç®¡ç†è¯¥çª—å£çš„æ¶ˆæ¯å’Œå‘é€æ“ä½œã€‚

**æ”¯æŒå±æ€§**ï¼š

| å±æ€§å  | ç±»å‹                  | è¯´æ˜                                     |
| ------- | --------------------- | ---------------------------------------- |
| who     | `str`                 | å½“å‰èŠå¤©çª—å£çš„å¯¹è±¡å                     |
| UiaAPI  | `uiautomation.Control`| å½“å‰èŠå¤©çª—å£çš„ UIAutomation æ§ä»¶         |
| editbox | `uiautomation.Control`| å½“å‰èŠå¤©çª—å£è¾“å…¥æ¡†çš„ UIAutomation æ§ä»¶   |

**æ”¯æŒæ–¹æ³•**ï¼š

| æ–¹æ³•å           | è¯´æ˜                                     |
| ---------------- | ---------------------------------------- |
| AtAll            | @æ‰€æœ‰äºº                                  |
| SendMsg          | å‘é€æ¶ˆæ¯                                 |
| SendFiles        | å‘é€æ–‡ä»¶                                 |
| SendEmotion      | å‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ…                         |
| SendTypingText   | å‘é€æ‰“å­—æœºæ¨¡å¼æ¶ˆæ¯                       |
| GetAllMessage    | è·å–æ‰€æœ‰æ¶ˆæ¯                             |
| GetNewMessage    | è·å–æ–°æ¶ˆæ¯                               |
| LoadMoreMessage  | åŠ è½½æ›´å¤šæ¶ˆæ¯                             |
| GetGroupMembers  | è·å–ç¾¤æˆå‘˜                               |
| CallGroupMsg     | å‘èµ·ç¾¤è¯­éŸ³é€šè¯                           |
| ModifyGroupInfo  | ä¿®æ”¹ç¾¤èŠä¿¡æ¯ï¼ˆç¾¤åç§°ã€å¤‡æ³¨ã€å…¬å‘Šç­‰ï¼‰       |

---

### 3. ä¼šè¯å¯¹è±¡

ä¼šè¯å¯¹è±¡ä»£è¡¨å¾®ä¿¡å·¦ä¾§çš„ä¼šè¯åˆ—è¡¨ï¼Œç”¨äºè·å–ä¼šè¯ç›¸å…³çš„ä¿¡æ¯ã€‚

**æ”¯æŒå±æ€§**ï¼š

| å±æ€§å  | ç±»å‹  | è¯´æ˜                       |
| ------- | ----- | -------------------------- |
| name    | `str` | ä¼šè¯å¯¹è±¡å                 |
| time    | `str` | æœ€åä¸€æ¡æ¶ˆæ¯çš„æ—¶é—´         |
| content | `str` | æœ€åä¸€æ¡æ¶ˆæ¯çš„å†…å®¹         |
| isnew   | `bool`| æ˜¯å¦æœ‰æ–°æ¶ˆæ¯               |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

sessions = wx.GetSession()

for session in sessions:
    print(f"============== ã€{session.name}ã€‘ ==============")
    print(f"æœ€åä¸€æ¡æ¶ˆæ¯æ—¶é—´: {session.time}")
    print(f"æœ€åä¸€æ¡æ¶ˆæ¯å†…å®¹: {session.content}")
    print(f"æ˜¯å¦æœ‰æ–°æ¶ˆæ¯: {session.isnew}", end='\n\n')
```

---

### 4. æœ‹å‹åœˆå¯¹è±¡

#### 4.1 çª—å£å¯¹è±¡

æœ‹å‹åœˆçª—å£å¯¹è±¡æŒ‡çš„æ˜¯æœ‹å‹åœˆçš„çª—å£å¯¹è±¡ï¼Œæä¾›å¯¹æœ‹å‹åœˆçª—å£çš„å„ç§æ“ä½œï¼Œå¦‚è·å–æœ‹å‹åœˆå†…å®¹ã€åˆ·æ–°ã€å…³é—­ç­‰åŠŸèƒ½ã€‚

**è·å–æœ‹å‹åœˆå¯¹è±¡**ï¼š

```python
from wxautox import WeChat

wx = WeChat()
pyq = wx.Moments()   
# æ‰“å¼€æœ‹å‹åœˆå¹¶è·å–æœ‹å‹åœˆçª—å£å¯¹è±¡
# ï¼ˆå¦‚æœä¸º None åˆ™è¯´æ˜æ‚¨æœªå¼€å¯æœ‹å‹åœˆåŠŸèƒ½ï¼Œéœ€è¦åœ¨æ‰‹æœºç«¯è®¾ç½®ï¼‰
```

**æœ‹å‹åœˆçª—å£å¯¹è±¡**

> è¿™é‡Œçš„ `pyq` å°†åœ¨åç»­æ–‡æ¡£ä¸­ç”¨æ¥æŒ‡ä»£æœ‹å‹åœˆçª—å£å¯¹è±¡ï¼Œåç»­æ–‡æ¡£å†…ä¸å†é‡å¤å®šä¹‰ã€‚

##### 4.1.1 è·å–æœ‹å‹åœˆå†…å®¹ `GetMoments`

**æ–¹æ³•è¯´æ˜**ï¼š

`GetMoments` æ–¹æ³•ç”¨äºè·å–æœ‹å‹åœˆå†…å®¹ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°      | ç±»å‹  | é»˜è®¤å€¼ | è¯´æ˜                                                         |
| --------- | ----- | ------ | ------------------------------------------------------------ |
| next_page | `bool`| `False`| æ˜¯å¦ç¿»é¡µåå†è·å–                                             |
| speed1    | `int` | `3`    | ç¿»é¡µæ—¶çš„æ»šåŠ¨é€Ÿåº¦ï¼Œæ•°å€¼è¶Šå¤§æ»šåŠ¨è¶Šå¿«ï¼Œä½†å¯èƒ½å¯¼è‡´é—æ¼ï¼Œå»ºè®® 3-10 ä¹‹é—´ |
| speed2    | `int` | `1`    | ç¿»é¡µæœ€åæ—¶çš„é€Ÿåº¦ï¼Œé¿å…ç¿»é¡µè¿‡å¤šå¯¼è‡´é—æ¼ï¼Œä¸€èˆ¬æ¯” `speed1` æ…¢ï¼Œå»ºè®® 1-3   |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# è·å–å½“å‰é¡µé¢çš„æœ‹å‹åœˆå†…å®¹
moments = pyq.GetMoments()

# é€šè¿‡ `next_page` å‚æ•°è·å–ä¸‹ä¸€é¡µçš„æœ‹å‹åœˆå†…å®¹
moments_next = pyq.GetMoments(next_page=True)
```

è·å–åˆ°çš„ `moments` æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæœ‹å‹åœˆå¯¹è±¡ã€‚

##### 4.1.2 åˆ·æ–°æœ‹å‹åœˆ `Refresh`

**æ–¹æ³•è¯´æ˜**ï¼š

`Refresh` æ–¹æ³•ç”¨äºåˆ·æ–°æœ‹å‹åœˆã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# åˆ·æ–°æœ‹å‹åœˆ
pyq.Refresh()
```

##### 4.1.3 å…³é—­æœ‹å‹åœˆ `Close`

**æ–¹æ³•è¯´æ˜**ï¼š

`Close` æ–¹æ³•ç”¨äºå…³é—­æœ‹å‹åœˆçª—å£ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# å…³é—­æœ‹å‹åœˆ
pyq.Close()
```

#### 4.2 æ¶ˆæ¯å¯¹è±¡

æœ‹å‹åœˆæ¶ˆæ¯å¯¹è±¡æŒ‡çš„æ˜¯æœ‹å‹åœˆä¸­çš„æ¯ä¸€æ¡æœ‹å‹åœˆï¼Œæä¾›å¯¹æœ‹å‹åœˆçš„å„ç§æ“ä½œï¼Œå¦‚è·å–æœ‹å‹åœˆå†…å®¹ã€ç‚¹èµã€è¯„è®ºç­‰åŠŸèƒ½ã€‚

**è·å–æœ‹å‹åœˆå¯¹è±¡**ï¼š

```python
moments = pyq.GetMoments()

# è·å–ç¬¬ä¸€æ¡æœ‹å‹åœˆ
moment = moments[0]
```

**æœ‹å‹åœˆæ¶ˆæ¯å¯¹è±¡**

> è¿™é‡Œçš„ `moment` å°†åœ¨åç»­æ–‡æ¡£ä¸­ç”¨æ¥æŒ‡ä»£æœ‹å‹åœˆæ¶ˆæ¯å¯¹è±¡ï¼Œåç»­æ–‡æ¡£å†…ä¸å†é‡å¤å®šä¹‰ã€‚

##### 4.2.1 è·å–æœ‹å‹åœˆå†…å®¹

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# è·å–æœ‹å‹åœˆå†…å®¹
info = moment.info
# ç¤ºä¾‹è¾“å‡º:
# {
#     'type': 'moment',            # ç±»å‹ï¼Œåˆ†ä¸º `æœ‹å‹åœˆ` å’Œ `å¹¿å‘Š`
#     'id': '4236572776458165',    # ID
#     'sender': 'å¤©å¤©é²œèŠ±2å·å®¢æœ',   # å‘é€è€…
#     'content': 'å®¢è®¢èŠ±æŸ',        # å†…å®¹ï¼Œå°±æ˜¯æœ‹å‹åœˆçš„æ–‡å­—å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰æ–‡å­—å†…å®¹åˆ™ä¸ºç©ºå­—ç¬¦ä¸²
#     'time': '4åˆ†é’Ÿå‰',            # å‘é€æ—¶é—´
#     'img_count': 3,              # å›¾ç‰‡æ•°é‡
#     'comments': [],              # è¯„è®º
#     'addr': '',                  # å‘é€ä½ç½®
#     'likes': []                  # ç‚¹èµ
# }
```

**è®¿é—®å±æ€§**ï¼š

```python
print(moment.sender)    # 'å¤©å¤©é²œèŠ±2å·å®¢æœ'
print(moment.content)   # 'å®¢è®¢èŠ±æŸ'
print(moment.time)      # '4åˆ†é’Ÿå‰'
# info ä¸­æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½å¯ä»¥é€šè¿‡å¯¹è±¡çš„å±æ€§æ¥è·å–ï¼Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†
```

##### 4.2.2 è·å–æœ‹å‹åœˆå›¾ç‰‡ `SaveImages`

**æ–¹æ³•è¯´æ˜**ï¼š

`SaveImages` æ–¹æ³•ç”¨äºä¿å­˜æœ‹å‹åœˆä¸­çš„å›¾ç‰‡åˆ°æœ¬åœ°ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°       | ç±»å‹          | é»˜è®¤å€¼ | è¯´æ˜                                                             |
| ---------- | ------------- | ------ | ---------------------------------------------------------------- |
| save_index | `int` / `list`| `None` | ä¿å­˜å›¾ç‰‡çš„ç´¢å¼•ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°æˆ–åˆ—è¡¨ï¼›å¦‚æœä¸º `None` åˆ™ä¿å­˜æ‰€æœ‰å›¾ç‰‡ |
| savepath   | `str`         | `None` | ç»å¯¹è·¯å¾„ï¼ŒåŒ…æ‹¬æ–‡ä»¶åå’Œåç¼€ï¼Œä¾‹å¦‚ï¼š"D:/Images/å¾®ä¿¡å›¾ç‰‡_xxxxxx.jpg"ï¼Œå¦‚æœä¸º `None` åˆ™ä¿å­˜åˆ°é»˜è®¤è·¯å¾„ |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# è·å–æœ‹å‹åœˆå›¾ç‰‡
images = moment.SaveImages()
# ç¤ºä¾‹è¾“å‡º:
# [
#     'D:/Images/å¾®ä¿¡å›¾ç‰‡_xxxxxx1.jpg',
#     'D:/Images/å¾®ä¿¡å›¾ç‰‡_xxxxxx2.jpg',
#     'D:/Images/å¾®ä¿¡å›¾ç‰‡_xxxxxx3.jpg',
#     ...
# ]
```

##### 4.2.3 è·å–å¥½å‹ä¿¡æ¯ `sender_info`

**æ–¹æ³•è¯´æ˜**ï¼š

é€šè¿‡æ¶ˆæ¯å¯¹è±¡è·å–å¥½å‹ï¼ˆç¾¤å¥½å‹ï¼‰ä¿¡æ¯ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()
msgs = wx.GetAllMessage()

# è·å–æœ€åä¸€æ¡æ¶ˆæ¯ï¼Œå‡è®¾ä¸ºå¥½å‹å‘æ¥çš„æ¶ˆæ¯
msg = msgs[-1]

# ä»…æ¶ˆæ¯ç±»å‹ä¸º `friend` çš„æ‰æœ‰è¯¥æ–¹æ³•
if msg.type == 'friend':
    sender_info = msg.sender_info()

# ç¤ºä¾‹è¾“å‡º:
# {
#     'nickname': 'å¼ ä¸‰',
#     'id': '123456',
#     'remark': 'åŒäº‹å¼ ä¸‰',
#     'tags': 'åŒäº‹',
#     'source': 'é€šè¿‡æ‰«ä¸€æ‰«æ·»åŠ ',
#     'signature': 'å¼ ä¸‰çš„ä¸ªæ€§ç­¾å'
# }
```

**è¿”å›å€¼è¯´æ˜**ï¼š

| é”®         | è¯´æ˜                                     |
| ---------- | ---------------------------------------- |
| nickname   | æ˜µç§°                                     |
| id         | æ¶ˆæ¯çš„ UI æ§ä»¶æå–åˆ°çš„ runtimeidï¼Œå”¯ä¸€ï¼Œä¸ç”¨å¯å¿½ç•¥ |
| remark     | å¤‡æ³¨                                     |
| tags       | æ ‡ç­¾                                     |
| source     | æ¥æº                                     |
| signature  | ä¸ªæ€§ç­¾å                                 |

##### 4.2.4 è·å–å½“å‰èŠå¤©é¡µé¢è¯¦æƒ… `details` å±æ€§

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# è·å–å½“å‰èŠå¤©çª—å£è¯¦æƒ…
details = wx.CurrentChat(details=True)
print(details)
# ç¤ºä¾‹è¾“å‡º:
# {
#     'chat_type': 'group', 
#     'chat_name': 'wxautoxå››ç¾¤', 
#     'group_member_count': 490
# }
```

**è¿”å›å€¼è¯´æ˜**ï¼š

| é”®                 | è¯´æ˜                                                           |
| ------------------ | -------------------------------------------------------------- |
| id                 | æ¶ˆæ¯çš„ UI æ§ä»¶æå–åˆ°çš„ runtimeidï¼Œå”¯ä¸€ï¼Œä¸ç”¨å¯å¿½ç•¥             |
| type               | æ¶ˆæ¯ç±»å‹ï¼Œ`friend` ä¸ºå…¶ä»–äººå‘çš„æ¶ˆæ¯ï¼Œ`time` æ—¶é—´æ¶ˆæ¯ï¼Œ`sys` ç³»ç»Ÿæ¶ˆæ¯ï¼Œ`self` è‡ªå·±å‘çš„æ¶ˆæ¯ |
| sender             | æ¶ˆæ¯å‘é€äººçš„æ˜µç§°                                               |
| content            | æ¶ˆæ¯å†…å®¹                                                       |
| sender_remark      | æ¶ˆæ¯å‘é€äººçš„å¤‡æ³¨ï¼Œæ²¡æœ‰åˆ™ä¸º `None`                              |
| chat_type          | èŠå¤©ç±»å‹ï¼Œ`group` ä¸ºç¾¤èŠï¼Œ`friend` ä¸ºå¥½å‹èŠå¤©ï¼Œ`official` ä¸ºå…¬ä¼—å· |
| chat_name          | å½“å‰èŠå¤©å¯¹è±¡åï¼Œç¾¤åæˆ–å¥½å‹å                                     |
| group_member_count | ç¾¤èŠäººæ•°ï¼Œå¦‚æœæ˜¯ç¾¤æ¶ˆæ¯åˆ™æœ‰è¯¥å‚æ•°                               |

##### 4.2.5 è§£æå¡ç‰‡é“¾æ¥ `parse_url` æ–¹æ³•

**æ–¹æ³•è¯´æ˜**ï¼š

`parse_url` æ–¹æ³•ç”¨äºè§£ææ¶ˆæ¯å†…çš„å¡ç‰‡é“¾æ¥ï¼Œå°†å…¶è½¬æ¢ä¸ºå¯ç‚¹å‡»çš„ URL æ ¼å¼ã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
# è§£ææ¶ˆæ¯å†…çš„å¡ç‰‡é“¾æ¥
msgs = wx.GetAllMessage(parseurl=True)
# ç¤ºä¾‹è¾“å‡º:
# [
#     ...
#     ['Time', '13:34'],
#     ['Self', '[wxautoxå¡ç‰‡é“¾æ¥è§£æ]https://mp.weixin.qq.com/s/x8ilebSF5_KYd0PloyZm-Q']
# ]
```

---

## æ–‡ä»¶ç®¡ç†å¯¹è±¡

### 1. æ–‡ä»¶çª—å£å¯¹è±¡

æ–‡ä»¶ç®¡ç†å¯¹è±¡ç”¨äºç®¡ç†å’Œæ“ä½œå¾®ä¿¡ä¸­çš„æ–‡ä»¶ï¼Œå¦‚èŠå¤©æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ã€‚

**æ”¯æŒå±æ€§**ï¼š

| å±æ€§å       | ç±»å‹                | è¯´æ˜                                     |
| ------------ | ------------------- | ---------------------------------------- |
| allfiles     | `ButtonControl`     | å…¨éƒ¨æ–‡ä»¶æŒ‰é’®                             |
| recentfiles  | `ButtonControl`     | æœ€è¿‘ä½¿ç”¨æŒ‰é’®                             |
| whofiles     | `ButtonControl`     | å‘é€è€…æŒ‰é’®                               |
| chatfiles    | `ButtonControl`     | èŠå¤©æ–‡ä»¶æŒ‰é’®                             |
| typefiles    | `ButtonControl`     | ç±»å‹æŒ‰é’®                                 |

**æ”¯æŒæ–¹æ³•**ï¼š

| æ–¹æ³•å          | è¯´æ˜                                     |
| --------------- | ---------------------------------------- |
| GetSessionName  | è·å–èŠå¤©å¯¹è±¡çš„åå­—                       |
| GetSessionList  | è·å–å½“å‰èŠå¤©å¯¹è±¡åˆ—è¡¨                     |
| ChatWithFile    | æ‰“å¼€æŒ‡å®šèŠå¤©ä¼šè¯                         |
| DownloadFiles   | ä¸‹è½½æŒ‡å®šèŠå¤©ä¼šè¯çš„æ–‡ä»¶                   |
| Close           | å…³é—­æ–‡ä»¶çª—å£                             |

#### 1.1 è·å–èŠå¤©å¯¹è±¡åç§°

**æ–¹æ³•è¯´æ˜**ï¼š

`GetSessionName` æ–¹æ³•ç”¨äºè·å–èŠå¤©å¯¹è±¡çš„åç§°ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°         | ç±»å‹                      | è¯´æ˜                       |
| ------------ | ------------------------- | -------------------------- |
| SessionItem  | `uiautomation.ListItemControl` | èŠå¤©å¯¹è±¡æ§ä»¶             |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

session_name = wx.WeChatFiles().GetSessionName(session_item)
print(session_name)  # è¾“å‡ºèŠå¤©å¯¹è±¡å
```

#### 1.2 è·å–èŠå¤©å¯¹è±¡åˆ—è¡¨

**æ–¹æ³•è¯´æ˜**ï¼š

`GetSessionList` æ–¹æ³•ç”¨äºè·å–å½“å‰èŠå¤©åˆ—è¡¨ä¸­çš„æ‰€æœ‰èŠå¤©å¯¹è±¡çš„åç§°ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°  | ç±»å‹  | é»˜è®¤å€¼ | è¯´æ˜                     |
| ----- | ----- | ------ | ------------------------ |
| reset | `bool`| `False`| æ˜¯å¦é‡ç½® `SessionItemList` |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

session_names = wx.WeChatFiles().GetSessionList()
print(session_names)  # è¾“å‡ºæ‰€æœ‰èŠå¤©å¯¹è±¡å
```

#### 1.3 æ‰“å¼€æŒ‡å®šèŠå¤©ä¼šè¯ `ChatWithFile`

**æ–¹æ³•è¯´æ˜**ï¼š

`ChatWithFile` æ–¹æ³•ç”¨äºæ‰“å¼€æŒ‡å®šçš„èŠå¤©ä¼šè¯ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜                       |
| ---- | ---- | ------ | -------------------------- |
| who  | `str`| /      | è¦æ‰“å¼€çš„èŠå¤©å¯¹è±¡å         |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# æ‰“å¼€æŒ‡å®šèŠå¤©ä¼šè¯
who = 'å¼ ä¸‰'
wx.WeChatFiles().ChatWithFile(who)
```

#### 1.4 ä¸‹è½½æ–‡ä»¶ `DownloadFiles`

**æ–¹æ³•è¯´æ˜**ï¼š

`DownloadFiles` æ–¹æ³•ç”¨äºä¸‹è½½æŒ‡å®šèŠå¤©ä¼šè¯ä¸­çš„æ–‡ä»¶ã€‚

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•°      | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜                                     |
| --------- | ---- | ------ | ---------------------------------------- |
| who       | `str`| /      | èŠå¤©å¯¹è±¡å                               |
| amount    | `int`| /      | ä¸‹è½½çš„æ–‡ä»¶æ•°é‡é™åˆ¶                       |
| deadline  | `str`| `None` | æˆªæ­¢æ—¥æœŸé™åˆ¶                             |
| size      | `str`| `None` | æ–‡ä»¶å¤§å°é™åˆ¶                             |

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# ä¸‹è½½æŒ‡å®šèŠå¤©ä¼šè¯ä¸­çš„æ–‡ä»¶
who = 'å·¥ä½œç¾¤A'
amount = 10
deadline = '2024-12-01'
size = '10MB'

wx.WeChatFiles().DownloadFiles(who, amount, deadline, size)
```

### 2. æ–‡ä»¶ç®¡ç†æ–¹æ³•

æ–‡ä»¶ç®¡ç†å¯¹è±¡æä¾›äº†å¤šç§æ–¹æ³•ç”¨äºç®¡ç†å’Œæ“ä½œå¾®ä¿¡ä¸­çš„æ–‡ä»¶ï¼Œå¦‚è·å–èŠå¤©å¯¹è±¡åˆ—è¡¨ã€ä¸‹è½½æ–‡ä»¶ç­‰ã€‚

---

## å…¶ä»–å¯¹è±¡

### WeChatFiles å¯¹è±¡

`WeChatFiles` å¯¹è±¡ç”¨äºç®¡ç†å¾®ä¿¡ä¸­çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬è·å–èŠå¤©å¯¹è±¡çš„æ–‡ä»¶åˆ—è¡¨ã€ä¸‹è½½æ–‡ä»¶ç­‰æ“ä½œã€‚

**ç¤ºä¾‹ä»£ç **ï¼š

```python
from wxautox import WeChat

wx = WeChat()

# è·å–æ‰€æœ‰èŠå¤©å¯¹è±¡çš„æ–‡ä»¶åˆ—è¡¨
session_names = wx.WeChatFiles().GetSessionList()

# ä¸‹è½½ç‰¹å®šèŠå¤©å¯¹è±¡çš„æ–‡ä»¶
wx.WeChatFiles().DownloadFiles(who='å¼ ä¸‰', amount=5)
```

---

## æ–°å¢åŠŸèƒ½

### 1. ç®¡ç†ç¾¤èŠ `ManageGroup`

- **æ–°å¢æ–¹æ³•**ï¼š`ManageGroup`
- **åŠŸèƒ½**ï¼šä¿®æ”¹ç¾¤èŠçš„åç§°ã€å¤‡æ³¨ã€å…¬å‘Šä»¥åŠä¸ªäººåœ¨ç¾¤å†…çš„æ˜µç§°ï¼Œæˆ–é€‰æ‹©é€€å‡ºç¾¤èŠã€‚

### 2. ç®¡ç†å¥½å‹ `ManageFriend`

- **æ–°å¢æ–¹æ³•**ï¼š`ManageFriend`
- **åŠŸèƒ½**ï¼šä¿®æ”¹å¥½å‹çš„å¤‡æ³¨ååŠå¢åŠ æ ‡ç­¾ã€‚

### 3. å‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ… `SendEmotion`

- **æ–°å¢æ–¹æ³•**ï¼š`SendEmotion`
- **åŠŸèƒ½**ï¼šå‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ…ã€‚

### 4. è‡ªåŠ¨è§£æå¡ç‰‡é“¾æ¥

- **æ–°å¢å‚æ•°**ï¼š`parseurl` åœ¨å¤šä¸ªæ–¹æ³•ä¸­æ–°å¢ï¼Œç”¨äºè‡ªåŠ¨è§£ææ¶ˆæ¯å†…å¡ç‰‡æ¶ˆæ¯çš„ URL é“¾æ¥ã€‚

### 5. è·å–ç¾¤æˆå‘˜ `GetGroupMembers`

- **æ–°å¢æ–¹æ³•**ï¼š`GetGroupMembers`
- **åŠŸèƒ½**ï¼šè·å–å½“å‰èŠå¤©ç¾¤æˆå‘˜åˆ—è¡¨ã€‚

### 6. å‘èµ·ç¾¤è¯­éŸ³é€šè¯ `CallGroupMsg`

- **æ–°å¢æ–¹æ³•**ï¼š`CallGroupMsg`
- **åŠŸèƒ½**ï¼šå‘èµ·ç¾¤è¯­éŸ³é€šè¯ã€‚

### 7. æ–‡ä»¶ç®¡ç†å¯¹è±¡ `WeChatFiles`

- **æ–°å¢å¯¹è±¡**ï¼š`WeChatFiles`
- **åŠŸèƒ½**ï¼šç®¡ç†å’Œæ“ä½œå¾®ä¿¡ä¸­çš„æ–‡ä»¶ï¼Œå¦‚èŠå¤©æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ã€‚

---

## æ›´æ–°æ—¥å¿—

**ç‰ˆæœ¬**ï¼šPlus Version 3.9.11.17.21  
**æ›´æ–°æ—¥æœŸ**ï¼š2024-12-17

**æ›´æ–°å†…å®¹**ï¼š

- æ–°å¢ `ManageGroup` æ–¹æ³•ï¼Œæ”¯æŒä¿®æ”¹ç¾¤èŠåç§°ã€å¤‡æ³¨ã€å…¬å‘ŠåŠä¸ªäººæ˜µç§°ã€‚
- æ–°å¢ `ManageFriend` æ–¹æ³•ï¼Œæ”¯æŒä¿®æ”¹å¥½å‹å¤‡æ³¨å’Œæ·»åŠ æ ‡ç­¾ã€‚
- æ–°å¢ `SendEmotion` æ–¹æ³•ï¼Œæ”¯æŒå‘é€è‡ªå®šä¹‰è¡¨æƒ…åŒ…ã€‚
- åœ¨å¤šä¸ªæ–¹æ³•ä¸­æ–°å¢ `parseurl` å‚æ•°ï¼Œæ”¯æŒè‡ªåŠ¨è§£ææ¶ˆæ¯ä¸­çš„ URL é“¾æ¥ã€‚
- æ–°å¢ `GetGroupMembers` æ–¹æ³•ï¼Œæ”¯æŒè·å–å½“å‰ç¾¤èŠçš„æˆå‘˜åˆ—è¡¨ã€‚
- æ–°å¢ `CallGroupMsg` æ–¹æ³•ï¼Œæ”¯æŒå‘èµ·ç¾¤è¯­éŸ³é€šè¯ã€‚
- æ–°å¢ `WeChatFiles` å¯¹è±¡ï¼Œæ”¯æŒæ–‡ä»¶ç®¡ç†å’Œä¸‹è½½æ“ä½œã€‚

---

## å¸¸è§é—®é¢˜

### Q1ï¼šå¦‚ä½•ç¡®ä¿ wxautox ä¸å¾®ä¿¡ç‰ˆæœ¬å…¼å®¹ï¼Ÿ

**ç­”**ï¼šè¯·ç¡®ä¿æ‚¨çš„å¾®ä¿¡å®¢æˆ·ç«¯ç‰ˆæœ¬ä¸ wxautox æ”¯æŒçš„ç‰ˆæœ¬ä¸€è‡´ã€‚ç›®å‰ wxautox æ”¯æŒå¾®ä¿¡ç‰ˆæœ¬ **3.9.11.17**ã€‚å¦‚æœå¾®ä¿¡ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†åŠŸèƒ½æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚

### Q2ï¼šå‘é€æ–‡ä»¶æ—¶é‡åˆ°é—®é¢˜æ€ä¹ˆåŠï¼Ÿ

**ç­”**ï¼šå‘é€æ–‡ä»¶æ—¶ï¼Œè¯·ç¡®ä¿æ–‡ä»¶è·¯å¾„æ­£ç¡®ä¸”æ–‡ä»¶å­˜åœ¨ã€‚å¦‚æœä»ç„¶é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®ç›®æ ‡æ–‡ä»¶å¤¹ï¼Œæˆ–å°è¯•å‡å°‘ä¸€æ¬¡å‘é€çš„æ–‡ä»¶æ•°é‡ã€‚

### Q3ï¼šè‡ªåŠ¨ä¿å­˜æ–‡ä»¶åŠŸèƒ½å­˜åœ¨ Bugï¼Œå¦‚ä½•è§£å†³ï¼Ÿ

**ç­”**ï¼šå¦‚æœåœ¨ä½¿ç”¨è‡ªåŠ¨ä¿å­˜æ–‡ä»¶åŠŸèƒ½æ—¶é‡åˆ° Bugï¼Œå»ºè®®å‡å°‘ä¸€æ¬¡ä¿å­˜çš„æ–‡ä»¶æ•°é‡ï¼Œæˆ–æ‰‹åŠ¨ä¿å­˜å¿…è¦çš„æ–‡ä»¶ã€‚åŒæ—¶ï¼Œæ¬¢è¿åœ¨å¾®ä¿¡ç¾¤å†…åé¦ˆé—®é¢˜ï¼Œæˆ‘ä»¬å°†åŠæ—¶ä¿®å¤ã€‚

---

## åé¦ˆä¸æ”¯æŒ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨ **wxautox** æ—¶é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åŠ å…¥æˆ‘ä»¬çš„å¾®ä¿¡ç¾¤è¿›è¡Œåé¦ˆå’Œäº¤æµã€‚æˆ‘ä»¬ä¼šå°½å¿«å“åº”å¹¶æä¾›æ”¯æŒã€‚

---

**å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®æ—¨åœ¨æä¾›å¾®ä¿¡è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­è¯·éµå®ˆå¾®ä¿¡çš„ç›¸å…³ä½¿ç”¨æ¡æ¬¾å’Œæ”¿ç­–ã€‚å¼€å‘è€…å¯¹ä½¿ç”¨æœ¬é¡¹ç›®å¯èƒ½å¸¦æ¥çš„ä»»ä½•åæœè‡ªè¡Œæ‰¿æ‹…è´£ä»»ã€‚